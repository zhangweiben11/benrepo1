<?xml version="1.1" encoding="UTF-8"?>
<!-- salt:cde82315-e936-41f1-90c6-32daeeda6afd -->
<metadata name="pkgPl_EligibilityCoverageDetail" path="/shared/Delta_DV/Physical/Formatting/PackagedQueries/Enrollment/pkgPl_EligibilityCoverageDetail" type="PROCEDURE" subtype="EXTERNAL_SQL_PROCEDURE" changeToken="0">
  <parameters>
    <parameter name="PersonId" direction="IN" nullable="true">
      <datatype name="VARCHAR" type="STRING" maxLength="16"/>
    </parameter>
    <parameter name="NetworkId" direction="IN" nullable="true">
      <datatype name="VARCHAR" type="STRING" maxLength="12"/>
    </parameter>
    <parameter name="NetworkFlag" direction="IN" nullable="true">
      <datatype name="INTEGER" type="INTEGER" minValue="-2147483648" maxValue="2147483647"/>
    </parameter>
    <parameter name="EnroleeContractFRMT" direction="IN" nullable="true">
      <datatype name="VARCHAR" type="STRING" maxLength="25"/>
    </parameter>
    <parameter name="EnroleeMemberFRMT" direction="IN" nullable="true">
      <datatype name="VARCHAR" type="STRING" maxLength="5"/>
    </parameter>
    <parameter name="ContractId" direction="IN" nullable="true">
      <datatype name="VARCHAR" type="STRING" maxLength="25"/>
    </parameter>
    <parameter name="AltID" direction="IN" nullable="true">
      <datatype name="VARCHAR" type="STRING" maxLength="25"/>
    </parameter>
    <parameter name="AltIDFlag" direction="IN" nullable="true">
      <datatype name="VARCHAR" type="STRING" maxLength="5"/>
    </parameter>
    <parameter name="GenericIDFieldIND" direction="IN" nullable="true">
      <datatype name="INTEGER" type="INTEGER" minValue="-2147483648" maxValue="2147483647"/>
    </parameter>
    <parameter name="GenericId" direction="IN" nullable="true">
      <datatype name="VARCHAR" type="STRING" maxLength="255"/>
    </parameter>
    <parameter name="GenericIdContractFRMT" direction="IN" nullable="true">
      <datatype name="VARCHAR" type="STRING" maxLength="255"/>
    </parameter>
    <parameter name="GenericIdMemberFRMT" direction="IN" nullable="true">
      <datatype name="VARCHAR" type="STRING" maxLength="255"/>
    </parameter>
    <parameter name="result" direction="OUT" nullable="true">
      <datatype name="CURSOR" type="TABLE" refId="256">
        <element name="ContractID">
          <datatype name="VARCHAR" type="STRING" maxLength="25"/>
        </element>
        <element name="MemberID">
          <datatype name="VARCHAR" type="STRING" maxLength="2"/>
        </element>
        <element name="EnroleeID">
          <datatype name="VARCHAR" type="STRING" maxLength="30"/>
        </element>
        <element name="GroupID">
          <datatype name="VARCHAR" type="STRING" maxLength="12"/>
        </element>
        <element name="GroupName">
          <datatype name="VARCHAR" type="STRING" maxLength="50"/>
        </element>
        <element name="DivisionID">
          <datatype name="VARCHAR" type="STRING" maxLength="12"/>
        </element>
        <element name="DivisionName">
          <datatype name="VARCHAR" type="STRING" maxLength="50"/>
        </element>
        <element name="CoverageType">
          <datatype name="VARCHAR" type="STRING" maxLength="4"/>
        </element>
        <element name="CoverageTypeCode">
          <datatype name="VARCHAR" type="STRING" maxLength="4"/>
        </element>
        <element name="CoverageTermReasonCode">
          <datatype name="VARCHAR" type="STRING" maxLength="4"/>
        </element>
        <element name="DivisionSelfFunded">
          <datatype name="VARCHAR" type="STRING" maxLength="5"/>
        </element>
        <element name="RelationShipCode">
          <datatype name="VARCHAR" type="STRING" maxLength="4"/>
        </element>
        <element name="RelationShip">
          <datatype name="VARCHAR" type="STRING" maxLength="80"/>
        </element>
        <element name="EffDate">
          <datatype name="VARCHAR" type="STRING" maxLength="25"/>
        </element>
        <element name="EndDate">
          <datatype name="VARCHAR" type="STRING" maxLength="25"/>
        </element>
        <element name="MemberTermReasonCode">
          <datatype name="VARCHAR" type="STRING" maxLength="4"/>
        </element>
        <element name="WaitingPeriod">
          <datatype name="VARCHAR" type="STRING" maxLength="1"/>
        </element>
        <element name="BenefitPkgID">
          <datatype name="VARCHAR" type="STRING" maxLength="12"/>
        </element>
        <element name="Bl4">
          <datatype name="VARCHAR" type="STRING" maxLength="12"/>
        </element>
        <element name="Bl5">
          <datatype name="VARCHAR" type="STRING" maxLength="12"/>
        </element>
        <element name="Bl6">
          <datatype name="VARCHAR" type="STRING" maxLength="12"/>
        </element>
        <element name="Bl7">
          <datatype name="VARCHAR" type="STRING" maxLength="12"/>
        </element>
        <element name="RegulatoryAgency">
          <datatype name="VARCHAR" type="STRING" maxLength="90"/>
        </element>
        <element name="DefaultNetworkID">
          <datatype name="VARCHAR" type="STRING" maxLength="12"/>
        </element>
        <element name="EmpGrpLvl3Id">
          <datatype name="VARCHAR" type="STRING" maxLength="25"/>
        </element>
        <element name="EmpGrpLvl4Id">
          <datatype name="VARCHAR" type="STRING" maxLength="25"/>
        </element>
      </datatype>
    </parameter>
  </parameters>
  <security>
    <owner user="nobody" domain="composite"/>
  </security>
  <dependency target="/shared/Delta_DV/Physical/Metadata/DataSources/IDS" type="DATA_SOURCE">
    <datatype name="Tree" type="TREE" refId="257"></datatype>
  </dependency>
  <attribute name="SQL" type="STRING">SELECT * FROM (SELECT DISTINCT
      &#x9;&#x9;   RTRIM(MEMBER_ELIGIBILITY.CONTRACT_ID) AS ContractID,
               MEMBER_ELIGIBILITY.MEMBER_ID AS MemberID,
&#x9;&#x9;&#x9;   CONCAT(RTRIM(MEMBER_ELIGIBILITY.CONTRACT_ID),MEMBER_ELIGIBILITY.MEMBER_ID ) AS EnroleeID,
&#x9;&#x9;&#x9;   RTRIM(COVERAGE_TYPE_SPAN.EMPGRP_LVL_1_ID) AS GroupID,
               EGL1.EMPGRP_LVL1_NAME AS GroupName,
               RTRIM(COVERAGE_TYPE_SPAN.EMPGRP_LVL_2_ID) AS DivisionID,
                EGL2.DIVISION_NAME AS DivisionName,
&#x9;&#x9;&#x9;   COVERAGE_TYPE_SPAN.RATE_PKG_ID_CD AS CoverageType,
&#x9;&#x9;       RTRIM(COVERAGE_TYPE_SPAN.CONTRACT_TYPE_CD) AS CoverageTypeCode,
&#x9;&#x9;&#x9;   COVERAGE_TYPE_SPAN.DISENROLL_RESN_CD AS CoverageTermReasonCode,
               CASE WHEN BDC.BILLING_ARRGMT_IND = &apos;A&apos; THEN &apos;Y&apos; ELSE &apos;N&apos;  END DivisionSelfFunded,
&#x9;&#x9;&#x9;   RTRIM(MEMBER_ELIGIBILITY.CLASS_CODE) AS RelationShipCode,
               REL_CODE.REPORT_DESC AS RelationShip,
              case when  MEMBER_ELIGIBILITY.EFFECTIVE_DATE &gt;= COVERAGE_TYPE_SPAN.EFFECTIVE_DATE then format(MEMBER_ELIGIBILITY.EFFECTIVE_DATE,&apos;MM/dd/yyyy&apos;)  else format(COVERAGE_TYPE_SPAN.EFFECTIVE_DATE,&apos;MM/dd/yyyy&apos;) end AS EffDate,
              case when MEMBER_ELIGIBILITY.END_DATE &lt;=COVERAGE_TYPE_SPAN.END_DATE then format(MEMBER_ELIGIBILITY.END_DATE,&apos;MM/dd/yyyy&apos;) else format(COVERAGE_TYPE_SPAN.END_DATE,&apos;MM/dd/yyyy&apos;) end as EndDate,
&#x9;&#x9;&#x9;   MEMBER_ELIGIBILITY.DISENR_REASON_CD AS MemberTermReasonCode,
&#x9;&#x9;&#x9;   MEMBER_ELIGIBILITY.APPLY_WAIT_PD_FG AS WaitingPeriod,
               MEMBER_ELIGIBILITY.BENEFIT_PKG_ID AS BenefitPkgID,
               RTRIM(MEMBER_ELIGIBILITY.BUS_LEVEL_4_ID) AS Bl4,
               RTRIM(MEMBER_ELIGIBILITY.BUS_LEVEL_5_ID) AS Bl5,
               RTRIM(MEMBER_ELIGIBILITY.BUS_LEVEL_6_ID) AS Bl6,
               RTRIM(MEMBER_ELIGIBILITY.BUS_LEVEL_7_ID) AS Bl7,
              DIV_GRP.REGULATORYAGENCY  as RegulatoryAgency,             
               RTRIM(mpna.NETWORK_IDENTIFIER) as DefaultNetworkID,
               COVERAGE_TYPE_SPAN.EMPGRP_LVL_3_ID AS EmpGrpLvl3Id,
               COVERAGE_TYPE_SPAN.EMPGRP_LVL_4_ID AS EmpGrpLvl4Id
 FROM     [MTV_VIEWS].[dbo].[MEMBER_VW] MEMBER 
INNER JOIN [MTV_VIEWS].[dbo].[COVERAGE_TYPE_SPAN_VW] COVERAGE_TYPE_SPAN
                                        ON MEMBER.CONTRACT_ID=COVERAGE_TYPE_SPAN.CONTRACT_ID
                                         AND  COVERAGE_TYPE_SPAN.VOID_FLAG=&apos;N&apos;
                                         AND  COVERAGE_TYPE_SPAN.AUDIT_FLAG=&apos;N&apos; AND MEMBER.AUDIT_FLAG = &apos;N&apos;
INNER JOIN  [MTV_VIEWS].[dbo].[MEMBER_ELIGIBILITY_VW] MEMBER_ELIGIBILITY
                                      ON MEMBER.CONTRACT_ID=MEMBER_ELIGIBILITY.CONTRACT_ID
                                      AND MEMBER.MEMBER_ID=MEMBER_ELIGIBILITY.MEMBER_ID
&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;  AND COVERAGE_TYPE_SPAN.contract_id=MEMBER_ELIGIBILITY.contract_id 
&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;  AND NOT (MEMBER_ELIGIBILITY.effective_date &gt; COVERAGE_TYPE_SPAN.end_date)
                                      AND NOT (MEMBER_ELIGIBILITY.end_date &lt; COVERAGE_TYPE_SPAN.effective_date)
                                      AND  MEMBER_ELIGIBILITY.VOID_FLAG = &apos;N&apos;
                                      AND MEMBER_ELIGIBILITY.AUDIT_FLAG = &apos;N&apos;  
INNER JOIN [MTV_VIEWS].[dbo].[EMP_GRP_LVL_1_VW] EGL1 
                                        ON EGL1.IDENTIFIER=COVERAGE_TYPE_SPAN.EMPGRP_LVL_1_ID
                                         AND EGL1.AUDIT_FLAG=&apos;N&apos; 
INNER JOIN [MTV_VIEWS].[dbo].[EMP_GRP_LVL_2_VW] EGL2 
                                        ON EGL2.IDENTIFIER=COVERAGE_TYPE_SPAN.EMPGRP_LVL_2_ID
&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9; and EGL2.EMPGRP_LEVEL_1_ID=COVERAGE_TYPE_SPAN.EMPGRP_LVL_1_ID
&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9; and EGL1.IDENTIFIER=EGL2.EMPGRP_LEVEL_1_ID
                                         AND EGL2.AUDIT_FLAG=&apos;N&apos;
LEFT OUTER JOIN [MTV_VIEWS].[dbo].[MBR_PROV_NTWK_ASSN_vw] mpna 
                                    on MEMBER_ELIGIBILITY.contract_id=mpna.contract_id and MEMBER_ELIGIBILITY.member_id=mpna.member_id  
                                    AND  MEMBER.contract_id=mpna.contract_id and MEMBER.member_id=mpna.member_id 
                                    AND COVERAGE_TYPE_SPAN.contract_id=mpna.contract_id 
                                    and mpna.audit_flag=&apos;N&apos; and mpna.void_flag=&apos;N&apos; 
&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;    AND NOT (mpna.effective_date &gt; COVERAGE_TYPE_SPAN.end_date)
                                    AND NOT (mpna.end_date &lt; COVERAGE_TYPE_SPAN.effective_date)
                                   and mpna.effective_date &lt;= MEMBER_ELIGIBILITY.end_date
                                   and mpna.end_date &gt;= MEMBER_ELIGIBILITY.effective_date 
LEFT OUTER JOIN [MTV_VIEWS].[dbo].[BILLING_DIV_CONFIG_VW] BDC
                                         ON COVERAGE_TYPE_SPAN.EMPGRP_LVL_1_ID = BDC.FK_EMPGRP_LVL1_ID
                                          AND COVERAGE_TYPE_SPAN.EMPGRP_LVL_2_ID = BDC.FK_BILL_ENT_ID  AND BDC.VOID_FLAG = &apos;N&apos;   
                                          AND COVERAGE_TYPE_SPAN.EFFECTIVE_DATE  between  BDC.EFF_DATE and BDC.END_DATE                              
LEFT OUTER JOIN [MTV_VIEWS].[dbo].[CODE_VALUE_VW] REL_CODE
                                              ON MEMBER_ELIGIBILITY.CLASS_CODE=REL_CODE.CODE_VALUE_ID 
                                             AND REL_CODE.FK_CODE_CATG_ID=&apos;CL&apos;
LEFT OUTER JOIN [EDA_STAR_VIEWS].[dbo].[GRP_DIV_REGAGENCY_VW]  DIV_GRP
                                   ON DIV_GRP.GRP_ID=COVERAGE_TYPE_SPAN.EMPGRP_LVL_1_ID
&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;    and DIV_GRP.DIV_ID =COVERAGE_TYPE_SPAN.EMPGRP_LVL_2_ID
LEFT OUTER JOIN [MTV_VIEWS].[dbo].[MBR_ALTERNATE_ID_VW] mbr_alternate_id 
                                      on MEMBER.CONTRACT_ID=mbr_alternate_id.CVG_CONTRACT_ID 
                                       and MEMBER.MEMBER_ID= mbr_alternate_id.member_id
                                        and mbr_alternate_id.AUDIT_FLAG=&apos;N&apos; and 
                                       mbr_alternate_id.VOID_FLAG=&apos;N&apos;

WHERE MEMBER.PERSON_ID=&apos;{0}&apos;  
AND (MEMBER_ELIGIBILITY.CONTRACT_ID=COALESCE(NULLIF(&apos;{3}&apos;,&apos;NULL&apos;), MEMBER_ELIGIBILITY.CONTRACT_ID) and MEMBER_ELIGIBILITY.MEMBER_ID=COALESCE(NULLIF(&apos;{4}&apos;,&apos;NULL&apos;), MEMBER_ELIGIBILITY.MEMBER_ID)) --EnrolleeId
AND MEMBER_ELIGIBILITY.CONTRACT_ID=COALESCE(NULLIF(&apos;{5}&apos;,&apos;NULL&apos;), MEMBER_ELIGIBILITY.CONTRACT_ID) --ContractID
and ((mbr_alternate_id.ALTERNATE_ID=&apos;{6}&apos; or &apos;{6}&apos;=&apos;NULL&apos;) and (mbr_alternate_id.ALTERNAT_ID_TYP_CD=&apos;{7}&apos; OR &apos;{7}&apos;=&apos;NULL&apos;))--All AltID(SUPP,ASN,CASE,RFC)
--Generic ID filter-start---------------
and( 
({8}=1 and MEMBER_ELIGIBILITY.CONTRACT_ID=&apos;{9}&apos; )-----------GENERICID_FILTER ON CONTRACT
or 
({8}=1 and (MEMBER_ELIGIBILITY.CONTRACT_ID=&apos;{10}&apos; and MEMBER_ELIGIBILITY.MEMBER_ID=&apos;{11}&apos;))----------GENERICID_FILTER ON ENROLEEID
or 
({8}=1 and mbr_alternate_id.ALTERNATE_ID=&apos;{9}&apos;)----------GENERICID_FILTER ON ALTERNATE_ID
or 
({8}=0)-------Scenario where GENERIC_ID is not passed in Search/Scenario where Generic ID passed is Either PERSONID or SSN
)
--Generic ID filter-end---------------

and ( ( {2}=1 AND(MEMBER_ELIGIBILITY.BUS_LEVEL_7_ID like &apos;{1}&apos; OR &apos;{1}&apos; =&apos;XX&apos; ))---DCUSA , DI and null Condition
      OR
  (  {2}=2  AND MEMBER_ELIGIBILITY.BUS_LEVEL_7_ID NOT like &apos;%D%CARE%&apos; AND MEMBER_ELIGIBILITY.BUS_LEVEL_7_ID NOT LIKE &apos;%DNTG%&apos;  )--DD condition
)
)A ORDER BY ContractID,convert(DATE,EndDate) desc
--ORDER BY 1,14 DESC
OPTION (MAXDOP 16)

--OPTION(USE HINT(&apos;ENABLE_PARALLEL_PLAN_PREFERENCE&apos;))
;</attribute>
  <attribute name="creationDate" type="LONG">1597304496806</attribute>
  <attribute name="creatorUserDomain" type="STRING">dev</attribute>
  <attribute name="creatorUserId" type="INTEGER">3980101</attribute>
  <attribute name="creatorUserName" type="STRING">dos59246</attribute>
  <attribute name="isSingleSelect" type="STRING">false</attribute>
  <attribute name="lastModifiedDate" type="LONG">1611118400986</attribute>
  <attribute name="lastModifiedUserDomain" type="STRING">dev</attribute>
  <attribute name="lastModifiedUserId" type="INTEGER">3980101</attribute>
  <attribute name="lastModifiedUserName" type="STRING">dos59246</attribute>
  <attribute name="passThroughSource" type="STRING">/shared/Delta_DV/Physical/Metadata/DataSources/IDS</attribute>
  <attribute name="resourceModifiedDateOnSourceCISSite" type="LONG">1597304496806</attribute>
</metadata>