<?xml version="1.1" encoding="UTF-8"?>
<!-- salt:cde82315-e936-41f1-90c6-32daeeda6afd -->
<metadata name="Service_Form_Fact_23_12_2020" path="/shared/Delta_DV/Application/Views/Reports/CCTA/Service_Form_Fact_23_12_2020" type="TABLE" subtype="SQL_TABLE" changeToken="0" tableType="VIEW">
  <columns></columns>
  <indexes></indexes>
  <foreignKeys></foreignKeys>
  <security>
    <owner user="nobody" domain="composite"/>
  </security>
  <dependency target="/shared/Delta_DV/Application/Views/Reports/CCTA/Service_Form_Fact_HLP_Service_Form_State" type="TABLE">
    <datatype name="Tree" type="TREE" refId="257"></datatype>
  </dependency>
  <dependency target="/shared/Delta_DV/Application/Views/Reports/CCTA/Service_Form_Fact_HLP_State_Date" type="TABLE">
    <datatype name="Tree" type="TREE" refId="257"></datatype>
  </dependency>
  <dependency target="/shared/Delta_DV/Business/BusinessSemantic/EDP/Customer_Service_Agent" type="TABLE">
    <datatype name="Tree" type="TREE" refId="257"></datatype>
  </dependency>
  <dependency target="/shared/Delta_DV/Business/BusinessSemantic/EDP/Customer_Service_Event" type="TABLE">
    <datatype name="Tree" type="TREE" refId="257"></datatype>
  </dependency>
  <dependency target="/shared/Delta_DV/Business/BusinessSemantic/EDP/Service_Form" type="TABLE">
    <datatype name="Tree" type="TREE" refId="257"></datatype>
  </dependency>
  <dependency target="/shared/Delta_DV/Business/BusinessSemantic/EDP/Service_Form_Category" type="TABLE">
    <datatype name="Tree" type="TREE" refId="257"></datatype>
  </dependency>
  <dependency target="/shared/Delta_DV/Business/BusinessSemantic/EDP/Service_Form_Resolution_Action" type="TABLE">
    <datatype name="Tree" type="TREE" refId="257"></datatype>
  </dependency>
  <dependency target="/shared/Delta_DV/Business/BusinessSemantic/EDP/Service_Form_State" type="TABLE">
    <datatype name="Tree" type="TREE" refId="257"></datatype>
  </dependency>
  <dependency target="/shared/Delta_DV/Business/BusinessSemantic/EDP/Stake_Holder_Cross_Reference" type="TABLE">
    <datatype name="Tree" type="TREE" refId="257"></datatype>
  </dependency>
  <dependency target="/shared/Delta_DV/Business/BusinessSemantic/EDP/Stakeholder_Event" type="TABLE">
    <datatype name="Tree" type="TREE" refId="257"></datatype>
  </dependency>
  <attribute name="SQL" type="STRING">--OPTION CASE_SENSITIVE=&quot;false&quot; is needed for a full push down of the query to the source system when a filter is used on the published view. 
--For example: Tableau is filtering on the Service_Form_Category_Name.
SELECT {OPTION CASE_SENSITIVE=&quot;false&quot;}  
    sf.Customer_Service_Event_Key,
    sf.Service_Form_Key,
    upper(sfs.Service_Form_State_Type_Code) as Service_Form_State_Type_Code,
    CASE 
        WHEN t.max_st_dt = sfs.State_Date and upper(sfs.Service_Form_State_Type_Code) in (&apos;CL&apos;, &apos;IC&apos;) THEN &apos;C&apos;
        ELSE &apos;O&apos;
    END AS Service_Form_Status_IND,
    CASE 
        WHEN t.max_st_dt = sfs.State_Date and upper(sfs.Service_Form_State_Type_Code) NOT IN (&apos;CL&apos;, &apos;IC&apos;) THEN t.min_st_dt
    END AS Service_Form_Open_Date,
    CASE 
        WHEN t.max_st_dt = sfs.State_Date and upper(sfs.Service_Form_State_Type_Code) IN (&apos;CL&apos;, &apos;IC&apos;) THEN sfs.State_Date
    END AS Service_Form_Closed_Date,
    CASE 
        WHEN t.min_st_dt = sfs.State_Date and upper(sfs.Service_Form_State_Type_Code) IN (&apos;CR&apos;, &apos;IO&apos;) THEN sfs.State_Date
        ELSE NULL
    END Start_Date,
    cse.Customer_Call_Center_Code,
    sf.State_Province_CD,
    sf.Service_Form_Contact_Type_Code,
    sf.Contact_Center_Case_Owner_Code,
    sf.Completed_In_Business_Days_Count,
    sf.Completed_In_Calendar_Days_Count,
    sf.In_Provider_Concierge_Workflow_Indicator,
    sf.Correspondence_Form_IND,
    sf.Call_Form_IND,
    sf.Resolution_Agent_Notes_Text,
    sf.Service_Form_Identifier,
    sf.Source_System_Plan_Sponsor_Identifier,
    sf.Source_System_Plan_Sponsor_Name,
    sf.Source_System_Plan_State_Code,
    sf.Source_System_Accounting_Partition_Identifier,
    sf.Plan_Information_Source_System_Name,
    sf.Service_Form_Subject_Name,
    CASE 
        WHEN sf.Service_Form_Subject_Name IS NULL THEN &apos;Y&apos;
        ELSE &apos;N&apos;
    END as Subject_Text_Empty_IND,
    sf.DMHC_Category_Name,
    sf.Provider_License_State_Code,
    sf.Provider_Billing_State_Code,
    sf.Source_System_Name,
    sf.Source_System_Unique_Identifier,
    sf.Regulatory_Agency_Code,
    sfc.Service_Form_Category_Name,
    CASE 
        WHEN sfc.Service_Form_Category_Name IS NULL THEN &apos;Y&apos;
        ELSE &apos;N&apos;
    END AS Category_Empty_IND,
    sfra.Service_Form_Resolution_Action,
    CASE 
        WHEN sfra.Service_Form_Resolution_Action IS NULL THEN &apos;Y&apos;
        ELSE &apos;N&apos;
    END AS Resolution_Empty_IND,
    CASE 
        WHEN upper(sfs.Service_Form_State_Type_Code) = &apos;CR&apos; THEN csa.Given_Name || &apos; &apos; || csa.Family_Name
    END AS Service_Form_Created_By,
    CASE 
        WHEN upper(sfs.Service_Form_State_Type_Code) = &apos;CL&apos; THEN csa.Given_Name || &apos; &apos; || csa.Family_Name
    END AS Service_Form_Closed_By,
  --  sf.Service_Form_Caller_Type_Code as Customer_Service_Caller_Type_Code,

--New Columns
&#x9;CASE WHEN UPPER(SFH.Service_Form_State_Type_Code) = &apos;IO&apos;
            THEN iocsa.Given_Name
        &#x9;ELSE NULL
       &#x9; END Service_Form_Opened_By_Agent_Name,
&#x9;CASE WHEN UPPER(SFH.Service_Form_State_Type_Code) = &apos;IO&apos;
            THEN iocsa.User_Identifier 
        &#x9;ELSE NULL
         END Service_Form_Opened_By_Agent_ID,
&#x9;CASE WHEN UPPER(SFH.Service_Form_State_Type_Code) = &apos;IO&apos;
            THEN iocsas.Given_Name || &apos; &apos; || iocsas.Family_Name
       &#x9; &#x9;ELSE NULL
         END Service_Form_Opened_By_Agent_Supervisor_Name,

&#x9;CASE WHEN UPPER(SFH.Service_Form_State_Type_Code) = &apos;IC&apos;
            THEN iocsa.Given_Name
        &#x9;ELSE NULL
       &#x9; END Service_Form_Closed_By_Agent_Name,
&#x9;CASE WHEN UPPER(SFH.Service_Form_State_Type_Code) = &apos;IC&apos;
            THEN iocsa.User_Identifier 
        &#x9;ELSE NULL
         END Service_Form_Closed_By_Agent_ID,
&#x9;CASE WHEN UPPER(SFH.Service_Form_State_Type_Code) = &apos;IC&apos;
            THEN iocsas.Given_Name || &apos; &apos; || iocsas.Family_Name
       &#x9; &#x9;ELSE NULL
         END Service_Form_Closed_By_Agent_Supervisor_Name,
CASE WHEN UPPER(SFH.Service_Form_State_Type_Code) = &apos;PE&apos;
            THEN iocsa.Given_Name
        &#x9;ELSE NULL
       &#x9; END Service_Form_Pended_By_Agent_Name,
&#x9;CASE WHEN UPPER(SFH.Service_Form_State_Type_Code) = &apos;PE&apos;
            THEN iocsa.User_Identifier 
        &#x9;ELSE NULL
         END Service_Form_Pended_By_Agent_ID,
&#x9;CASE WHEN UPPER(SFH.Service_Form_State_Type_Code) = &apos;PE&apos;
            THEN iocsas.Given_Name || &apos; &apos; || iocsas.Family_Name
       &#x9; &#x9;ELSE NULL
         END Service_Form_Pended_By_Agent_Supervisor_Name,
CASE WHEN UPPER(SFH.Service_Form_State_Type_Code) = &apos;IO&apos;
            THEN sfs.Service_Form_Workstream_Name
        &#x9;ELSE NULL
       &#x9; END Service_Form_Opened_Queue_Name,
CASE WHEN UPPER(SFH.Service_Form_State_Type_Code) = &apos;PE&apos;
            THEN sfs.Service_Form_Workstream_Name
        &#x9;ELSE NULL
       &#x9; END Service_Form_Pended_Queue_Name,
CASE WHEN UPPER(SFH.Service_Form_State_Type_Code) = &apos;IC&apos;
            THEN sfs.Service_Form_Workstream_Name
        &#x9;ELSE NULL
       &#x9; END Service_Form_Closed_Queue_Name,
  CASE WHEN shcr.Stakeholder_Role_Type_Code = &apos;MEMBR&apos;
 THEN shcr.Stakeholder_Key  END AS Member_Key,
  CASE WHEN shcr.Stakeholder_Role_Type_Code = &apos;PRVDR&apos;
 THEN shcr.Stakeholder_Key  END AS Provider_Key
FROM /shared/Delta_DV/Business/BusinessSemantic/EDP/Service_Form sf INNER JOIN 
        /shared/Delta_DV/Business/BusinessSemantic/EDP/Service_Form_State sfs
    ON (sf.Service_Form_Key) = (sfs.Service_Form_Key)
    --INNER JOIN t
    --New join to helper view replaces old view
    INNER JOIN 
        /shared/Delta_DV/Application/Views/Reports/CCTA/Service_Form_Fact_HLP_Service_Form_State t
    ON t.Service_Form_Key = sfs.Service_Form_Key and t.max_st_dt = sfs.State_Date INNER JOIN 
/shared/Delta_DV/Business/BusinessSemantic/EDP/Customer_Service_Agent csa
    ON upper(cast(csa.Source_System_Identifier as varchar(100))) = upper(cast(sfs.Source_System_User_Login_Identifier as varchar(100))) LEFT OUTER JOIN 
        (SELECT 
            Service_Form_Key,
            MAX(upper(Service_Form_Category_Name)) as Service_Form_Category_Name
        FROM /shared/Delta_DV/Business/BusinessSemantic/EDP/Service_Form_Category
        group by Service_Form_Key) as sfc
    ON sfc.Service_Form_Key = sfs.Service_Form_Key LEFT OUTER JOIN 
        (SELECT 
            Service_Form_Key,
            MAX(upper(Service_Form_Resolution_Action)) AS Service_Form_Resolution_Action
        FROM /shared/Delta_DV/Business/BusinessSemantic/EDP/Service_Form_Resolution_Action
        group by Service_Form_Key) as sfra
    ON upper(cast(sfra.Service_Form_Key as varchar(100))) = upper(cast(sfs.Service_Form_Key as varchar(100))) INNER JOIN 
        /shared/Delta_DV/Business/BusinessSemantic/EDP/Customer_Service_Event cse
    ON cse.Customer_Service_Event_Key = sf.Customer_Service_Event_Key
--Inner Join for newly added columns

INNER JOIN /shared/Delta_DV/Application/Views/Reports/CCTA/Service_Form_Fact_HLP_State_Date SFH
&#x9;ON SFH.Service_Form_Key = sfs.Service_Form_Key
&#x9;INNER JOIN /shared/Delta_DV/Business/BusinessSemantic/EDP/Customer_Service_Agent iocsa
ON upper(cast(iocsa.Source_System_Identifier as varchar(100)))  = upper(cast(sfs.Source_System_User_Login_Identifier as varchar(100))) 

--For Supervisor
INNER JOIN /shared/Delta_DV/Business/BusinessSemantic/EDP/Customer_Service_Agent iocsas
ON upper(cast(iocsas.Source_System_Identifier as varchar(100)))  = upper(cast(iocsa.Supervisor_Key as varchar(100))) 
LEFT OUTER JOIN  /shared/Delta_DV/Business/BusinessSemantic/EDP/Stakeholder_Event se
ON sf.Customer_Service_Event_Key = se.Event_Key
LEFT OUTER JOIN /shared/Delta_DV/Business/BusinessSemantic/EDP/Stake_Holder_Cross_Reference shcr
ON upper(cast(se.Stakeholder_Role_Cross_Reference_Key as varchar)) = upper(cast(shcr.Stakeholder_Role_Cross_Reference_Key as varchar))

</attribute>
  <attribute name="creationDate" type="LONG">1608737741962</attribute>
  <attribute name="creatorUserDomain" type="STRING">dev</attribute>
  <attribute name="creatorUserId" type="INTEGER">5310113</attribute>
  <attribute name="creatorUserName" type="STRING">dos90129</attribute>
  <attribute name="explicitly.designed" type="BOOLEAN">false</attribute>
  <attribute name="impactLevel" type="INTEGER">32</attribute>
  <attribute name="impactMessage" type="STRING">Invalid column name &apos;Service_Form_State_Type_Code&apos;.  On line 67, column 18.  [parser-2900650]</attribute>
  <attribute name="lastModifiedDate" type="LONG">1609896176534</attribute>
  <attribute name="lastModifiedUserDomain" type="STRING">composite</attribute>
  <attribute name="lastModifiedUserId" type="INTEGER">5310113</attribute>
  <attribute name="lastModifiedUserName" type="STRING">admin</attribute>
  <attribute name="model" type="NULL"/>
  <attribute name="resourceModifiedDateOnSourceCISSite" type="LONG">1608737741962</attribute>
</metadata>