<?xml version="1.1" encoding="UTF-8"?>
<!-- salt:cde82315-e936-41f1-90c6-32daeeda6afd -->
<metadata name="prcBl_MemberRequest" path="/shared/Delta_DV/Business/Logical/Enrollment/Procedures/prcBl_MemberRequest" type="PROCEDURE" subtype="SQL_SCRIPT_PROCEDURE" changeToken="0">
  <parameters>
    <parameter name="inSearchJson" direction="IN" nullable="true">
      <datatype name="VARCHAR" type="STRING" maxLength="50000"/>
    </parameter>
    <parameter name="outMemberRequest" direction="OUT" nullable="true">
      <datatype name="outMemberRequest" type="TABLE" refId="256">
        <element name="FirstName">
          <datatype name="VARCHAR" type="STRING" maxLength="255"/>
        </element>
        <element name="LastName">
          <datatype name="VARCHAR" type="STRING" maxLength="255"/>
        </element>
        <element name="DateOfBirth">
          <datatype name="VARCHAR" type="STRING" maxLength="255"/>
        </element>
        <element name="Brand">
          <datatype name="VARCHAR" type="STRING" maxLength="255"/>
        </element>
        <element name="SSN">
          <datatype name="VARCHAR" type="STRING" maxLength="255"/>
        </element>
        <element name="ContractId">
          <datatype name="VARCHAR" type="STRING" maxLength="255"/>
        </element>
        <element name="Enrolleeid">
          <datatype name="VARCHAR" type="STRING" maxLength="255"/>
        </element>
        <element name="PersonId">
          <datatype name="VARCHAR" type="STRING" maxLength="255"/>
        </element>
        <element name="SubscriberId">
          <datatype name="VARCHAR" type="STRING" maxLength="255"/>
        </element>
        <element name="AlternateSubscriberId">
          <datatype name="VARCHAR" type="STRING" maxLength="255"/>
        </element>
        <element name="CaseId">
          <datatype name="VARCHAR" type="STRING" maxLength="255"/>
        </element>
        <element name="RfcId">
          <datatype name="VARCHAR" type="STRING" maxLength="255"/>
        </element>
        <element name="GenericId">
          <datatype name="VARCHAR" type="STRING" maxLength="255"/>
        </element>
      </datatype>
    </parameter>
  </parameters>
  <security>
    <owner user="nobody" domain="composite"/>
  </security>
  <dependency target="/services/databases/system/DUAL" type="TABLE">
    <datatype type="TABLE" refId="256">
      <element name="DUMMY">
        <datatype type="STRING" minLength="1" maxLength="1"/>
      </element>
    </datatype>
  </dependency>
  <attribute name="Script" type="STRING">PROCEDURE prcBl_MemberRequest(IN inSearchJson VARCHAR(50000), OUT outMemberRequest PIPE(
&#x9;&#x9;FirstName VARCHAR(255),
&#x9;&#x9;LastName VARCHAR(255),
&#x9;&#x9;DateOfBirth VARCHAR(255),
        Brand VARCHAR(255),
&#x9;&#x9;SSN VARCHAR(255),
&#x9;&#x9;ContractId VARCHAR(255),
&#x9;&#x9;Enrolleeid VARCHAR(255),
        PersonId VARCHAR(255),
&#x9;&#x9;SubscriberId VARCHAR(255),
&#x9;&#x9;AlternateSubscriberId VARCHAR(255),
&#x9;    CaseId VARCHAR(255),
        RfcId VARCHAR(255),
&#x9;&#x9;GenericId VARCHAR(255)
&#x9;&#x9;)
)
    BEGIN
        DECLARE varSearchJson VARCHAR(40000);
        DECLARE varSearchDetails VARCHAR(40000);

&#x9;&#x9;DECLARE jRow ROW(
&#x9;&#x9;FirstName VARCHAR(255),
&#x9;&#x9;LastName VARCHAR(255),
&#x9;&#x9;DateOfBirth VARCHAR(255),
        Brand VARCHAR(255),
&#x9;&#x9;SSN VARCHAR(255),
        ContractId VARCHAR(255),
&#x9;&#x9;Enrolleeid VARCHAR(255),
        PersonId VARCHAR(255),
&#x9;&#x9;SubscriberId VARCHAR(255),
&#x9;&#x9;AlternateSubscriberId VARCHAR(255),
&#x9;    CaseId VARCHAR(255),
        RfcId VARCHAR(255),
&#x9;&#x9;GenericId VARCHAR(255)
&#x9;&#x9;
&#x9;&#x9;
);

   SET varSearchJson = inSearchJson;


        SELECT 
            SearchDetails INTO varSearchDetails 
&#x9;    FROM JSON_TABLE(varSearchJson,&apos;$&apos;COLUMNS(SearchDetails VARCHAR(400000) PATH &apos;$.membershipSearchRequest&apos;)) JT,
            (select 
                varSearchJson as varSearchJson
            from /services/databases/system/DUAL) t2;

&#x9;&#x9;SELECT 
       -- case when SearchDetails.FirstName = &apos;&apos; THEN &apos;NULL&apos; ELSE TRIM(UPPER(SearchDetails.FirstName)) END AS FirstName, &#x9;&#x9;
       --case when SearchDetails.FirstName = &apos;&apos; THEN &apos;NULL&apos; ELSE TRIM(UPPER(replace(replace(SearchDetails.FirstName,&apos;&amp;apos;&apos;,&apos;&apos;&apos;&apos;),&apos;&amp;quot;&apos;,&apos;&quot;&apos;))) END AS FirstName,
case when SearchDetails.FirstName = &apos;&apos; THEN &apos;NULL&apos; ELSE TRIM(&apos; &apos; FROM UPPER(replace(replace(SearchDetails.FirstName,&apos;&amp;apos;&apos;,&apos;&apos;&apos;&apos;),&apos;&amp;quot;&apos;,&apos;&quot;&apos;))) END AS FirstName,      
&#x9;--  case when replace(SearchDetails.FirstName,&apos;&amp;tab;&apos;,&apos;&apos;) = &apos;&apos; THEN &apos;NULL&apos; ELSE TRIM(&apos; &apos; FROM UPPER(replace(replace(replace(SearchDetails.FirstName,&apos;&amp;apos;&apos;,&apos;&apos;&apos;&apos;),&apos;&amp;quot;&apos;,&apos;&quot;&apos;),&apos;&amp;tab;&apos;,&apos;&#x9;&apos;))) END AS FirstName,
     
   --case when SearchDetails.LastName  = &apos;&apos; THEN &apos;NULL&apos; ELSE TRIM(UPPER(SearchDetails.LastName)) END AS LastName,
       -- case when SearchDetails.LastName  = &apos;&apos; THEN &apos;NULL&apos; ELSE TRIM(UPPER(replace(replace(SearchDetails.LastName,&apos;&amp;apos;&apos;,&apos;&apos;&apos;&apos;),&apos;&amp;quot;&apos;,&apos;&quot;&apos;))) END AS LastName,
case when SearchDetails.LastName  = &apos;&apos; THEN &apos;NULL&apos; ELSE TRIM(&apos; &apos; FROM UPPER(replace(replace(SearchDetails.LastName,&apos;&amp;apos;&apos;,&apos;&apos;&apos;&apos;),&apos;&amp;quot;&apos;,&apos;&quot;&apos;))) END AS LastName,
    --  case when replace(SearchDetails.LastName,&apos;&amp;tab;&apos;,&apos;&apos;)  = &apos;&apos; THEN &apos;NULL&apos; ELSE TRIM(&apos; &apos; FROM UPPER(replace(replace(replace(SearchDetails.LastName,&apos;&amp;apos;&apos;,&apos;&apos;&apos;&apos;),&apos;&amp;quot;&apos;,&apos;&quot;&apos;),&apos;&amp;tab;&apos;,&apos;&#x9;&apos;))) END AS LastName,
&#x9;&#x9;case when SearchDetails.DateOfBirth =&apos;&apos; THEN &apos;NULL&apos; ELSE TRIM(SearchDetails.DateOfBirth) END AS Dateofbirth,
&#x9;&#x9;case when SearchDetails.Brand =&apos;&apos; THEN NULL ELSE TRIM(UPPER(SearchDetails.Brand)) END AS NetworkId,
        case when SearchDetails.SSN =&apos;&apos; THEN NULL ELSE TRIM(SearchDetails.SSN) END AS SSN ,
        case when SearchDetails.ContractId=&apos;&apos; THEN &apos;NULL&apos; ELSE TRIM(SearchDetails.ContractId) END AS ContractId ,
&#x9;&#x9;case when SearchDetails.Enrolleeid =&apos;&apos; THEN &apos;NULL&apos; ELSE TRIM(SearchDetails.Enrolleeid) END AS Enrolleeid,&#x9;&#x9;
&#x9;&#x9;case when SearchDetails.PersonId=&apos;&apos; THEN &apos;NULL&apos; ELSE TRIM(SearchDetails.PersonId) END AS PersonId ,
        case when SearchDetails.SubscriberId=&apos;&apos; THEN &apos;NULL&apos; ELSE TRIM(SearchDetails.SubscriberId) END AS SubscriberId,
&#x9;&#x9;case when SearchDetails.AlternateSubscriberId =&apos;&apos; THEN &apos;NULL&apos; ELSE TRIM(SearchDetails.AlternateSubscriberId) END AS AlternateSubscriberId,
&#x9;    case when SearchDetails.CaseId=&apos;&apos; THEN &apos;NULL&apos; ELSE TRIM(SearchDetails.CaseId) END AS CaseId,
        case when SearchDetails.RfcId=&apos;&apos; THEN &apos;NULL&apos; ELSE TRIM(SearchDetails.RfcId) END AS RfcId,
&#x9;&#x9;case when SearchDetails.GenericId=&apos;&apos; or SearchDetails.GenericId IS NULL THEN &apos;NULL&apos; ELSE TRIM(SearchDetails.GenericId) END AS GenericId

&#x9;&#x9;/*case when replace(SearchDetails.DateOfBirth,&apos;&amp;tab;&apos;,&apos;&apos;) =&apos;&apos; THEN &apos;NULL&apos; ELSE TRIM(replace(SearchDetails.DateOfBirth,&apos;&amp;tab;&apos;,&apos;&apos;)) END AS Dateofbirth,
&#x9;&#x9;case when replace(SearchDetails.Brand,&apos;&amp;tab;&apos;,&apos;&apos;) =&apos;&apos; THEN NULL ELSE TRIM(UPPER(replace(SearchDetails.Brand,&apos;&amp;tab;&apos;,&apos;&apos;))) END AS NetworkId,
        case when replace(SearchDetails.SSN,&apos;&amp;tab;&apos;,&apos;&apos;) =&apos;&apos; THEN NULL ELSE TRIM(replace(SearchDetails.SSN,&apos;&amp;tab;&apos;,&apos;&apos;)) END AS SSN ,
        case when replace(SearchDetails.ContractId,&apos;&amp;tab;&apos;,&apos;&apos;)=&apos;&apos; THEN &apos;NULL&apos; ELSE TRIM(replace(SearchDetails.ContractId,&apos;&amp;tab;&apos;,&apos;&apos;)) END AS ContractId ,
&#x9;&#x9;case when replace(SearchDetails.Enrolleeid,&apos;&amp;tab;&apos;,&apos;&apos;) =&apos;&apos; THEN &apos;NULL&apos; ELSE TRIM(replace(SearchDetails.Enrolleeid,&apos;&amp;tab;&apos;,&apos;&apos;)) END AS Enrolleeid,&#x9;&#x9;
&#x9;&#x9;case when replace(SearchDetails.PersonId,&apos;&amp;tab;&apos;,&apos;&apos;)=&apos;&apos; THEN &apos;NULL&apos; ELSE TRIM(replace(SearchDetails.PersonId,&apos;&amp;tab;&apos;,&apos;&apos;)) END AS PersonId ,
        case when replace(SearchDetails.SubscriberId,&apos;&amp;tab;&apos;,&apos;&apos;)=&apos;&apos; THEN &apos;NULL&apos; ELSE TRIM(replace(SearchDetails.SubscriberId,&apos;&amp;tab;&apos;,&apos;&apos;)) END AS SubscriberId,
&#x9;&#x9;case when replace(SearchDetails.AlternateSubscriberId,&apos;&amp;tab;&apos;,&apos;&apos;) =&apos;&apos; THEN &apos;NULL&apos; ELSE TRIM(replace(SearchDetails.AlternateSubscriberId,&apos;&amp;tab;&apos;,&apos;&apos;)) END AS AlternateSubscriberId,
&#x9;    case when replace(SearchDetails.CaseId,&apos;&amp;tab;&apos;,&apos;&apos;)=&apos;&apos; THEN &apos;NULL&apos; ELSE TRIM(replace(SearchDetails.CaseId,&apos;&amp;tab;&apos;,&apos;&apos;)) END AS CaseId,
        case when replace(SearchDetails.RfcId,&apos;&amp;tab;&apos;,&apos;&apos;)=&apos;&apos; THEN &apos;NULL&apos; ELSE TRIM(replace(SearchDetails.RfcId,&apos;&amp;tab;&apos;,&apos;&apos;)) END AS RfcId,
&#x9;&#x9;case when replace(SearchDetails.GenericId,&apos;&amp;tab;&apos;,&apos;&apos;)=&apos;&apos; or SearchDetails.GenericId IS NULL THEN &apos;NULL&apos; ELSE TRIM(replace(SearchDetails.GenericId,&apos;&amp;tab;&apos;,&apos;&apos;)) END AS GenericId*/

&#x9;&#x9;INTO 
&#x9;&#x9;&#x9;&#x9;jRow.FirstName,
&#x9;&#x9;&#x9;&#x9;jRow.LastName,
&#x9;&#x9;&#x9;&#x9;jRow.DateOfBirth,
                jRow.Brand,
&#x9;&#x9;&#x9;&#x9;jRow.SSN,
                jRow.ContractId,
&#x9;&#x9;&#x9;&#x9;jRow.Enrolleeid&#x9;,&#x9;
                jRow.PersonId,&#x9;&#x9;
&#x9;&#x9;&#x9;&#x9;jRow.SubscriberId,
&#x9;&#x9;&#x9;&#x9;jRow.AlternateSubscriberId,
&#x9;&#x9;&#x9;&#x9;jRow.CaseId,
                jRow.RfcId,
&#x9;&#x9;&#x9;&#x9;jRow.GenericId
&#x9;&#x9;&#x9;&#x9;
&#x9;&#x9;&#x9;&#x9;
&#x9;&#x9;FROM JSON_TABLE(t2.SearchDetails,&apos;$&apos; 
&#x9;&#x9;COLUMNS(
&#x9;&#x9;&#x9;&#x9;FirstName VARCHAR(255) PATH &apos;$.firstName&apos;,
&#x9;&#x9;&#x9;&#x9;LastName VARCHAR(255) PATH &apos;$.lastName&apos;,
&#x9;&#x9;&#x9;&#x9;DateOfBirth VARCHAR(255) PATH &apos;$.dateOfBirth&apos;,
                Brand VARCHAR(255) PATH &apos;$.brand&apos;,
&#x9;&#x9;&#x9;&#x9;SSN VARCHAR(255) PATH &apos;$.ssn&apos;,
&#x9;&#x9;&#x9;&#x9;ContractId VARCHAR(255) PATH &apos;$.contractId&apos;,
&#x9;&#x9;&#x9;&#x9;Enrolleeid VARCHAR(255) PATH &apos;$.enrolleeId&apos;,
                PersonId VARCHAR(255) PATH &apos;$.personId&apos;,
&#x9;&#x9;&#x9;&#x9;SubscriberId VARCHAR(255) PATH &apos;$.suppliedId&apos;,
&#x9;&#x9;&#x9;&#x9;AlternateSubscriberId VARCHAR(255) PATH &apos;$.assignedId&apos;,
&#x9;&#x9;&#x9;&#x9;CaseId VARCHAR(255) PATH &apos;$.caseId&apos;,
                RfcId VARCHAR(255) PATH &apos;$.rfcId&apos; ,
&#x9;&#x9;&#x9;&#x9;GenericId VARCHAR(255) PATH &apos;$.genericId&apos;
&#x9;&#x9;&#x9;&#x9;
&#x9;&#x9;)) SearchDetails,
&#x9;&#x9;(select varSearchDetails as SearchDetails
&#x9;&#x9;&#x9;&#x9;&#x9;from /services/databases/system/DUAL) t2;
&#x9;&#x9;
&#x9;&#x9;&#x9;&#x9;INSERT INTO outMemberRequest values(
&#x9;&#x9;&#x9;&#x9;jRow.FirstName,
&#x9;&#x9;&#x9;&#x9;jRow.LastName,
&#x9;&#x9;&#x9;&#x9;jRow.DateOfBirth,
                jRow.Brand,
&#x9;&#x9;&#x9;&#x9;jRow.SSN,
&#x9;&#x9;&#x9;&#x9;jRow.ContractId,
&#x9;&#x9;&#x9;&#x9;jRow.Enrolleeid,
                jRow.PersonId,
&#x9;&#x9;&#x9;&#x9;jRow.SubscriberId,
&#x9;&#x9;&#x9;&#x9;jRow.AlternateSubscriberId,
&#x9;&#x9;&#x9;&#x9;jRow.CaseId,
                jRow.RfcId,
&#x9;&#x9;&#x9;&#x9;jRow.GenericId
&#x9;&#x9;&#x9;&#x9;
&#x9;&#x9;&#x9;&#x9;
);

END</attribute>
  <attribute name="creationDate" type="LONG">1597213246542</attribute>
  <attribute name="creatorUserDomain" type="STRING">dev</attribute>
  <attribute name="creatorUserId" type="INTEGER">3980101</attribute>
  <attribute name="creatorUserName" type="STRING">dos59246</attribute>
  <attribute name="explicitly.designed" type="BOOLEAN">false</attribute>
  <attribute name="lastModifiedDate" type="LONG">1612944305305</attribute>
  <attribute name="lastModifiedUserDomain" type="STRING">dev</attribute>
  <attribute name="lastModifiedUserId" type="INTEGER">3980101</attribute>
  <attribute name="lastModifiedUserName" type="STRING">dos59246</attribute>
  <attribute name="model" type="NULL"/>
  <attribute name="native_only" type="STRING">false</attribute>
  <attribute name="references" type="NULL"/>
  <attribute name="resourceModifiedDateOnSourceCISSite" type="LONG">1597213246542</attribute>
</metadata>