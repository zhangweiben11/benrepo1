<?xml version="1.1" encoding="UTF-8"?>
<!-- salt:4eac6a34-df40-4265-b123-32a6ac34cac2 -->
<metadata name="pSendEmail" path="/shared/CoE/MonitorServer/Common/pSendEmail" type="PROCEDURE" subtype="SQL_SCRIPT_PROCEDURE" changeToken="0">
  <parameters>
    <parameter name="debug" direction="IN" nullable="true">
      <datatype name="CHAR" type="STRING" minLength="1" maxLength="1"/>
    </parameter>
    <parameter name="emailFormat" direction="IN" nullable="true">
      <datatype name="VARCHAR" type="STRING" maxLength="255"/>
    </parameter>
    <parameter name="subject" direction="IN" nullable="true">
      <datatype name="LONGVARCHAR" type="STRING" maxLength="2147483647"/>
    </parameter>
    <parameter name="message" direction="IN" nullable="true">
      <datatype name="LONGVARCHAR" type="STRING" maxLength="2147483647"/>
    </parameter>
    <parameter name="status" direction="OUT" nullable="true">
      <datatype name="VARCHAR" type="STRING" maxLength="255"/>
    </parameter>
    <parameter name="errMessage" direction="OUT" nullable="true">
      <datatype name="LONGVARCHAR" type="STRING" maxLength="2147483647"/>
    </parameter>
  </parameters>
  <security>
    <owner user="admin" domain="composite"/>
  </security>
  <dependency target="/lib/debug/Log" type="PROCEDURE">
    <datatype type="PROCEDURE" refId="258">
      <element name="textToLog" direction="IN">
        <datatype referenceDefinitionSet="/lib/util/System" referenceType="Text" type="STRING" maxLength="2147483647"/>
      </element>
    </datatype>
  </dependency>
  <dependency target="/lib/debug/Print" type="PROCEDURE">
    <datatype type="PROCEDURE" refId="258">
      <element name="textToPrint" direction="IN">
        <datatype referenceDefinitionSet="/lib/util/System" referenceType="Text" type="STRING" maxLength="2147483647"/>
      </element>
    </datatype>
  </dependency>
  <dependency target="/lib/util/SendEMail" type="PROCEDURE">
    <datatype type="PROCEDURE" refId="258">
      <element name="from" direction="IN">
        <datatype referenceDefinitionSet="/lib/util/System" referenceType="EMailAddress" type="STRING" maxLength="1024"/>
      </element>
      <element name="replyTo" direction="IN">
        <datatype referenceDefinitionSet="/lib/util/System" referenceType="EMailAddress" type="STRING" maxLength="1024"/>
      </element>
      <element name="to" direction="IN">
        <datatype referenceDefinitionSet="/lib/util/System" referenceType="EMailAddress" type="STRING" maxLength="1024"/>
      </element>
      <element name="cc" direction="IN">
        <datatype referenceDefinitionSet="/lib/util/System" referenceType="EMailAddress" type="STRING" maxLength="1024"/>
      </element>
      <element name="bcc" direction="IN">
        <datatype referenceDefinitionSet="/lib/util/System" referenceType="EMailAddress" type="STRING" maxLength="1024"/>
      </element>
      <element name="subject" direction="IN">
        <datatype referenceDefinitionSet="/lib/util/System" referenceType="PropertyValue" type="STRING" maxLength="4096"/>
      </element>
      <element name="contentType" direction="IN">
        <datatype referenceDefinitionSet="/lib/util/System" referenceType="PropertyName" type="STRING" maxLength="255"/>
      </element>
      <element name="content" direction="IN">
        <datatype referenceDefinitionSet="/lib/util/System" referenceType="Content" type="STRING" maxLength="65535"/>
      </element>
    </datatype>
  </dependency>
  <dependency target="/shared/CoE/MonitorServer/Customize/commonValues" type="PROCEDURE">
    <datatype type="PROCEDURE" refId="258"></datatype>
  </dependency>
  <attribute name="Script" type="STRING">/*
&#x9;pSendEmail:

&#x9;This procedure provides a standard way to send email for the MonitorServer module.

&#x9;INPUT:
&#x9;&#x9;debug&#x9;&#x9;&#x9;CHAR(1),&#x9;&#x9;-- Y=debug on.  N=debug off.
&#x9;&#x9;emailFormat &#x9;VARCHAR,&#x9;&#x9;-- TEXT_PLAIN or TEXT_HTML
&#x9;&#x9;subject&#x9;&#x9;&#x9;LONGVARCHAR,&#x9;-- Email subject
&#x9;&#x9;message&#x9;&#x9;&#x9;LONGVARCHAR,&#x9;-- Email message

&#x9;OUTPUT:
&#x9;&#x9;status&#x9;&#x9;&#x9;VARCHAR,&#x9;&#x9;-- SUCCESS or FAIL
&#x9;&#x9;errMessage&#x9;&#x9;LONGVARCHAR&#x9;&#x9;-- Error message

&#x9;Release:&#x9;Modified Date:&#x9;Modified By:&#x9;&#x9;DV Version:&#x9;&#x9;Reason:
&#x9;2020.200&#x9;05/27/2020&#x9;&#x9;Mike Tinius&#x9;&#x9;&#x9;7.0.8&#x9;&#x9;&#x9;Created new.

&#x9;(c) 2017 TIBCO Software Inc.  All rights reserved.
&#x9;
&#x9;Except as specified below, this software is licensed pursuant to the Eclipse Public License v. 1.0.
&#x9;The details can be found in the file LICENSE.
&#x9;
&#x9;The following proprietary files are included as a convenience, and may not be used except pursuant
&#x9;to valid license to Composite Information Server or TIBCOÂ® Data Virtualization Server:
&#x9;csadmin-XXXX.jar, csarchive-XXXX.jar, csbase-XXXX.jar, csclient-XXXX.jar, cscommon-XXXX.jar,
&#x9;csext-XXXX.jar, csjdbc-XXXX.jar, csserverutil-XXXX.jar, csserver-XXXX.jar, cswebapi-XXXX.jar,
&#x9;and customproc-XXXX.jar (where -XXXX is an optional version number).  Any included third party files
&#x9;are licensed under the terms contained in their own accompanying LICENSE files, generally named .LICENSE.txt.
&#x9;
&#x9;This software is licensed AS-IS. Support for this software is not covered by standard maintenance agreements with TIBCO.
&#x9;If you would like to obtain assistance with this software, such assistance may be obtained through a separate paid consulting
&#x9;agreement with TIBCO.

*/
PROCEDURE pSendEmail(
&#x9;IN debug&#x9;&#x9;&#x9;CHAR(1),&#x9;&#x9;-- Y=debug on.  N=debug off.
&#x9;IN emailFormat &#x9;&#x9;VARCHAR,&#x9;&#x9;-- TEXT_PLAIN or TEXT_HTML
&#x9;IN subject&#x9;&#x9;&#x9;LONGVARCHAR,&#x9;-- Email subject
&#x9;IN message&#x9;&#x9;&#x9;LONGVARCHAR,&#x9;-- Email message
&#x9;OUT status&#x9;&#x9;&#x9;VARCHAR,&#x9;&#x9;-- SUCCESS or FAIL
&#x9;OUT errMessage&#x9;&#x9;LONGVARCHAR&#x9;&#x9;-- Error message
)
BEGIN
&#x9;DECLARE moduleName&#x9;&#x9;&#x9;&#x9;&#x9;VARCHAR DEFAULT &apos;MonitorServer/Common/pSendEmail&apos;;
&#x9;DECLARE sendTo&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;LONGVARCHAR DEFAULT /shared/CoE/MonitorServer/Customize/commonValues.defaultEmail;
    DECLARE emailSubject &#x9;&#x9;&#x9;&#x9;LONGVARCHAR DEFAULT subject;
&#x9;DECLARE emailMessage&#x9;&#x9;&#x9;&#x9;LONGVARCHAR DEFAULT message;
&#x9;DECLARE logLabel&#x9;&#x9;&#x9;&#x9;&#x9;VARCHAR DEFAULT &apos;MonitorServer-&apos;;
    DECLARE sendBy &#x9;&#x9;&#x9;&#x9;&#x9;&#x9;VARCHAR DEFAULT null; 
    DECLARE replyToDefault &#x9;&#x9;&#x9;&#x9;VARCHAR DEFAULT null;
    DECLARE sendToDefault &#x9;&#x9;&#x9;&#x9;VARCHAR DEFAULT null;
    DECLARE copyToDefault &#x9;&#x9;&#x9;&#x9;VARCHAR DEFAULT null;
    DECLARE bccToDefault &#x9;&#x9;&#x9;&#x9;VARCHAR DEFAULT null;
&#x9;DECLARE lengthWarningMessageLimit&#x9;BIGINT DEFAULT 10000;

&#x9;SET status = &apos;SUCCESS&apos;;

&#x9;-- Send the email
&#x9;if (sendTo is not null) then
&#x9;&#x9;-- Make sure any blank email addresses are set to null or an exception will be thrown for &quot;illegal address&quot;
&#x9;&#x9;if (sendBy is not null and length(trim(sendBy)) = 0) then
&#x9;&#x9;&#x9;set sendBy = null;
&#x9;&#x9;end if;
&#x9;&#x9;if (replyToDefault is not null and length(trim(replyToDefault)) = 0) then
&#x9;&#x9;&#x9;set replyToDefault = null;
&#x9;&#x9;end if;
&#x9;&#x9;if (copyToDefault is not null and length(trim(copyToDefault)) = 0) then
&#x9;&#x9;&#x9;set copyToDefault = null;
&#x9;&#x9;end if;
&#x9;&#x9;if (bccToDefault is not null and length(trim(bccToDefault)) = 0) then
&#x9;&#x9;&#x9;set bccToDefault = null;
&#x9;&#x9;end if;

&#x9;&#x9;if (UPPER(debug) = &apos;Y&apos;) then
&#x9;&#x9;&#x9;call print(&apos;--------------------------------------------------------------------------------------------------------------&apos;);
&#x9;&#x9;&#x9;call print(moduleName||&apos; : Sending message of size [&apos;||length(message)||&apos;]&apos;);
&#x9;&#x9;&#x9;call print(moduleName||&apos; : Sending message with sendBy [&apos;||NVL(sendBy,&apos;null&apos;)||&apos;]&apos;);
&#x9;&#x9;&#x9;call print(moduleName||&apos; : Sending message with replyToDefault [&apos;||NVL(replyToDefault,&apos;null&apos;)||&apos;]&apos;);
&#x9;&#x9;&#x9;call print(moduleName||&apos; : Sending message with copyToDefault [&apos;||NVL(copyToDefault,&apos;null&apos;)||&apos;]&apos;);
&#x9;&#x9;&#x9;call print(moduleName||&apos; : Sending message with bccToDefault [&apos;||NVL(bccToDefault,&apos;null&apos;)||&apos;]&apos;);
&#x9;&#x9;&#x9;call print(moduleName||&apos; : Sending message with sendto [&apos;||NVL(sendTo,&apos;null&apos;)||&apos;]&apos;);
&#x9;&#x9;&#x9;call print(moduleName||&apos; : Sending message with subject [&apos;||NVL(emailSubject,&apos;null&apos;)||&apos;]&apos;);
&#x9;&#x9;&#x9;call print(moduleName||&apos; : Sending message with emailFormat [&apos;||NVL(emailFormat,&apos;null&apos;)||&apos;]&apos;);
&#x9;&#x9;&#x9;call print(moduleName||&apos; : Sending message with emailMessage:&apos;||chr(10)||SUBSTRING(emailMessage,1,63000));
&#x9;&#x9;end if;

&#x9;&#x9;BEGIN INDEPENDENT TRANSACTION
&#x9;&#x9;&#x9;CALL /lib/util/SendEMail (
&#x9;&#x9;&#x9;&#x9;sendBy, 
&#x9;&#x9;&#x9;&#x9;replyToDefault,
&#x9;&#x9;&#x9;&#x9;sendTo,
&#x9;&#x9;&#x9;&#x9;copyToDefault, 
&#x9;&#x9;&#x9;&#x9;bccToDefault,
&#x9;&#x9;&#x9;&#x9;emailSubject,
&#x9;&#x9;&#x9;&#x9;emailFormat,
&#x9;&#x9;&#x9;&#x9;emailMessage
&#x9;&#x9;&#x9;);
&#x9;&#x9;EXCEPTION
&#x9;&#x9;&#x9;ELSE
&#x9;&#x9;&#x9;&#x9;set errMessage = logLabel||moduleName||&apos; : EMAIL SEND EXCEPTION: &apos;||CAST(CURRENT_EXCEPTION.TRACE AS LONGVARCHAR);
&#x9;&#x9;&#x9;&#x9;set status = &apos;FAIL&apos;;
&#x9;&#x9;&#x9;&#x9;call log(errMessage);
&#x9;&#x9;&#x9;&#x9;if (UPPER(debug) = &apos;Y&apos;) then
&#x9;&#x9;&#x9;&#x9;&#x9;call print(SUBSTRING(errMessage, 1,63900));
&#x9;&#x9;&#x9;&#x9;end if;
&#x9;&#x9;END;
&#x9;else
&#x9;&#x9;set status = &apos;FAIL&apos;;
&#x9;&#x9;set errMessage = logLabel||&apos;No emails sent due to &quot;sendTo&quot; is null.&apos;;
&#x9;&#x9;call log(errMessage);
&#x9;&#x9;if (UPPER(debug) = &apos;Y&apos;) then
&#x9;&#x9;&#x9;call print(NVL(errMessage,&apos;null&apos;));
&#x9;&#x9;end if;
&#x9;end if;
END</attribute>
  <attribute name="creationDate" type="LONG">1582729764334</attribute>
  <attribute name="creatorUserDomain" type="STRING">composite</attribute>
  <attribute name="creatorUserId" type="INTEGER">-1973</attribute>
  <attribute name="creatorUserName" type="STRING">admin</attribute>
  <attribute name="explicitly.designed" type="BOOLEAN">false</attribute>
  <attribute name="lastModifiedDate" type="LONG">1601333668980</attribute>
  <attribute name="lastModifiedUserDomain" type="STRING">composite</attribute>
  <attribute name="lastModifiedUserId" type="INTEGER">-1973</attribute>
  <attribute name="lastModifiedUserName" type="STRING">admin</attribute>
  <attribute name="model" type="NULL"/>
  <attribute name="native_only" type="STRING">false</attribute>
  <attribute name="references" type="MAP">
    <item>
      <key type="STRING">11/105</key>
      <value type="STRING_ARRAY">
        <item>lib</item>
        <item>debug</item>
        <item>Print</item>
      </value>
    </item>
    <item>
      <key type="STRING">9/79</key>
      <value type="STRING_ARRAY">
        <item>lib</item>
        <item>debug</item>
        <item>Print</item>
      </value>
    </item>
    <item>
      <key type="STRING">9/113</key>
      <value type="STRING_ARRAY">
        <item>lib</item>
        <item>debug</item>
        <item>Print</item>
      </value>
    </item>
    <item>
      <key type="STRING">9/84</key>
      <value type="STRING_ARRAY">
        <item>lib</item>
        <item>debug</item>
        <item>Print</item>
      </value>
    </item>
    <item>
      <key type="STRING">9/85</key>
      <value type="STRING_ARRAY">
        <item>lib</item>
        <item>debug</item>
        <item>Print</item>
      </value>
    </item>
    <item>
      <key type="STRING">9/82</key>
      <value type="STRING_ARRAY">
        <item>lib</item>
        <item>debug</item>
        <item>Print</item>
      </value>
    </item>
    <item>
      <key type="STRING">9/83</key>
      <value type="STRING_ARRAY">
        <item>lib</item>
        <item>debug</item>
        <item>Print</item>
      </value>
    </item>
    <item>
      <key type="STRING">9/77</key>
      <value type="STRING_ARRAY">
        <item>lib</item>
        <item>debug</item>
        <item>Print</item>
      </value>
    </item>
    <item>
      <key type="STRING">9/78</key>
      <value type="STRING_ARRAY">
        <item>lib</item>
        <item>debug</item>
        <item>Print</item>
      </value>
    </item>
    <item>
      <key type="STRING">9/76</key>
      <value type="STRING_ARRAY">
        <item>lib</item>
        <item>debug</item>
        <item>Print</item>
      </value>
    </item>
    <item>
      <key type="STRING">8/111</key>
      <value type="STRING_ARRAY">
        <item>lib</item>
        <item>debug</item>
        <item>Log</item>
      </value>
    </item>
    <item>
      <key type="STRING">10/103</key>
      <value type="STRING_ARRAY">
        <item>lib</item>
        <item>debug</item>
        <item>Log</item>
      </value>
    </item>
    <item>
      <key type="STRING">9/80</key>
      <value type="STRING_ARRAY">
        <item>lib</item>
        <item>debug</item>
        <item>Print</item>
      </value>
    </item>
    <item>
      <key type="STRING">9/81</key>
      <value type="STRING_ARRAY">
        <item>lib</item>
        <item>debug</item>
        <item>Print</item>
      </value>
    </item>
  </attribute>
  <attribute name="resourceModifiedDateOnSourceCISSite" type="LONG">1582729764334</attribute>
</metadata>