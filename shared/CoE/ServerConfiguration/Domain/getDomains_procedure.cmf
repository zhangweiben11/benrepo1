<?xml version="1.1" encoding="UTF-8"?>
<!-- salt:4eac6a34-df40-4265-b123-32a6ac34cac2 -->
<metadata name="getDomains" path="/shared/CoE/ServerConfiguration/Domain/getDomains" type="PROCEDURE" subtype="SQL_SCRIPT_PROCEDURE" changeToken="0">
  <annotation><![CDATA[getDomains:

&#x9;This procedure is used to get the list of domains and domain attributes

&#x9;INPUT:
&#x9;&#x9;debug&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;CHAR(1),&#x9;-- Y=debug on.  N=debug off.
&#x9;&#x9;getAttributes&#x9;&#x9;&#x9;&#x9;CHAR(1), &#x9;-- Y=get all domain attributes.  N=get domains only with no attributes.

&#x9;OUTPUT:
&#x9;&#x9;result&#x9;&#x9;&#x9;&#x9;&#x9;PIPE(
&#x9;&#x9;&#x9;domainName &#x9;&#x9;&#x9;VARCHAR,&#x9;&#x9;-- The name of the domain
&#x9;&#x9;&#x9;domainType &#x9;&#x9;&#x9;VARCHAR, &#x9;&#x9;-- The type of domain [LDAP,COMPOSITE,DYNAMIC]
&#x9;&#x9;&#x9;annotation &#x9;&#x9;&#x9;VARCHAR&#x9;&#x9;&#x9;-- The annotation for the domain.
&#x9;&#x9;&#x9;attributeName &#x9;&#x9;VARCHAR, &#x9;&#x9;-- The attribute name
&#x9;&#x9;&#x9;attributeType &#x9;&#x9;VARCHAR, &#x9;&#x9;-- The attribute type [STRING,PASSWORD_STRING]
&#x9;&#x9;&#x9;attributeValue &#x9;&#x9;LONGVARCHAR, &#x9;-- The attribute value
&#x9;&#x9;)

&#x9;Release:&#x9;Modified Date:&#x9;Modified By:&#x9;&#x9;CSW Version:&#x9;Reason:
&#x9;2020.200&#x9;06/29/2020&#x9;&#x9;Mike Tinius&#x9;&#x9;&#x9;7.0.8&#x9;&#x9;&#x9;Created new

&#x9;(c) 2017 TIBCO Software Inc.  All rights reserved.
&#x9;
&#x9;Except as specified below, this software is licensed pursuant to the Eclipse Public License v. 1.0.
&#x9;The details can be found in the file LICENSE.
&#x9;
&#x9;The following proprietary files are included as a convenience, and may not be used except pursuant
&#x9;to valid license to Composite Information Server or TIBCOÂ® Data Virtualization Server:
&#x9;csadmin-XXXX.jar, csarchive-XXXX.jar, csbase-XXXX.jar, csclient-XXXX.jar, cscommon-XXXX.jar,
&#x9;csext-XXXX.jar, csjdbc-XXXX.jar, csserverutil-XXXX.jar, csserver-XXXX.jar, cswebapi-XXXX.jar,
&#x9;and customproc-XXXX.jar (where -XXXX is an optional version number).  Any included third party files
&#x9;are licensed under the terms contained in their own accompanying LICENSE files, generally named .LICENSE.txt.
&#x9;
&#x9;This software is licensed AS-IS. Support for this software is not covered by standard maintenance agreements with TIBCO.
&#x9;If you would like to obtain assistance with this software, such assistance may be obtained through a separate paid consulting
&#x9;agreement with TIBCO.]]></annotation>
  <parameters>
    <parameter name="debug" direction="IN" nullable="true">
      <datatype name="CHAR" type="STRING" minLength="1" maxLength="1"/>
    </parameter>
    <parameter name="getAttributes" direction="IN" nullable="true">
      <datatype name="CHAR" type="STRING" minLength="1" maxLength="1"/>
    </parameter>
    <parameter name="result" direction="OUT" nullable="true">
      <datatype name="result" type="TABLE" refId="256">
        <element name="domainName">
          <datatype name="VARCHAR" type="STRING" maxLength="255"/>
        </element>
        <element name="domainType">
          <datatype name="VARCHAR" type="STRING" maxLength="255"/>
        </element>
        <element name="annotation">
          <datatype name="LONGVARCHAR" type="STRING" maxLength="2147483647"/>
        </element>
        <element name="attributeName">
          <datatype name="VARCHAR" type="STRING" maxLength="255"/>
        </element>
        <element name="attributeType">
          <datatype name="VARCHAR" type="STRING" maxLength="255"/>
        </element>
        <element name="attributeValue">
          <datatype name="LONGVARCHAR" type="STRING" maxLength="2147483647"/>
        </element>
      </datatype>
    </parameter>
  </parameters>
  <security>
    <owner user="admin" domain="composite"/>
  </security>
  <dependency target="/lib/debug/Log" type="PROCEDURE">
    <datatype type="PROCEDURE" refId="258">
      <element name="textToLog" direction="IN">
        <datatype referenceDefinitionSet="/lib/util/System" referenceType="Text" type="STRING" maxLength="2147483647"/>
      </element>
    </datatype>
  </dependency>
  <dependency target="/lib/debug/Print" type="PROCEDURE">
    <datatype type="PROCEDURE" refId="258">
      <element name="textToPrint" direction="IN">
        <datatype referenceDefinitionSet="/lib/util/System" referenceType="Text" type="STRING" maxLength="2147483647"/>
      </element>
    </datatype>
  </dependency>
  <dependency target="/services/webservices/system/admin/user/operations/getDomains" type="PROCEDURE">
    <datatype type="PROCEDURE" refId="258">
      <element name="getDomains" direction="IN">
        <datatype name="getDomains" extendedName="{http://www.compositesw.com/services/system/admin/user}getDomains" namespace="http://www.compositesw.com/services/system/admin/user" referenceDefinitionSet="/services/webservices/system/admin/user/operations/UserSchema" referenceType="{http://www.compositesw.com/services/system/admin/user}getDomains" subType="ELEMENT_DECL" type="XML" contentConstraint="SEQUENCE" schemaConstraint="ANY" componentType="ELEMENT" componentName="{http://www.compositesw.com/services/system/admin/user}getDomains">
          <schemaDatatype>
            <datatype name="getDomains" namespace="http://www.compositesw.com/services/system/admin/user" superTypeName="getDomainsRequest" superTypeNamespace="http://www.compositesw.com/services/system/admin/user" subType="ELEMENT_DECL" type="TREE" refId="257">
              <element name="detail" namespace="http://www.compositesw.com/services/system/admin/user">
                <datatype name="detailLevel" namespace="http://www.compositesw.com/services/system/util/common" superTypeName="string" superTypeNamespace="http://www.w3.org/2001/XMLSchema" subType="SIMPLE_TYPE" type="STRING" maxLength="2147483647"/>
              </element>
            </datatype>
          </schemaDatatype>
        </datatype>
      </element>
      <element name="getDomainsResponse" direction="OUT">
        <datatype name="getDomainsResponse" extendedName="{http://www.compositesw.com/services/system/admin/user}getDomainsResponse" namespace="http://www.compositesw.com/services/system/admin/user" referenceDefinitionSet="/services/webservices/system/admin/user/operations/UserSchema" referenceType="{http://www.compositesw.com/services/system/admin/user}getDomainsResponse" subType="ELEMENT_DECL" type="XML" contentConstraint="SEQUENCE" schemaConstraint="ANY" componentType="ELEMENT" componentName="{http://www.compositesw.com/services/system/admin/user}getDomainsResponse">
          <schemaDatatype>
            <datatype name="getDomainsResponse" namespace="http://www.compositesw.com/services/system/admin/user" superTypeName="getDomainsResponse" superTypeNamespace="http://www.compositesw.com/services/system/admin/user" subType="ELEMENT_DECL" type="TREE" refId="513">
              <element name="domains" namespace="http://www.compositesw.com/services/system/admin/user">
                <datatype name="domainList" namespace="http://www.compositesw.com/services/system/admin/user" superTypeName="anyType" superTypeNamespace="http://www.w3.org/2001/XMLSchema" subType="COMPLEX_TYPE" type="TREE" refId="769">
                  <element name="domain" namespace="http://www.compositesw.com/services/system/admin/user" maxOccurs="2147483647" minOccurs="0">
                    <datatype name="domain" namespace="http://www.compositesw.com/services/system/admin/user" superTypeName="anyType" superTypeNamespace="http://www.w3.org/2001/XMLSchema" subType="COMPLEX_TYPE" type="TREE" refId="1025">
                      <element name="name" namespace="http://www.compositesw.com/services/system/admin/user">
                        <datatype name="string" namespace="http://www.w3.org/2001/XMLSchema" superTypeName="anySimpleType" superTypeNamespace="http://www.w3.org/2001/XMLSchema" type="STRING" maxLength="2147483647"/>
                      </element>
                      <element name="domainType" namespace="http://www.compositesw.com/services/system/admin/user">
                        <datatype name="domainTypeValue" namespace="http://www.compositesw.com/services/system/admin/user" superTypeName="string" superTypeNamespace="http://www.w3.org/2001/XMLSchema" subType="SIMPLE_TYPE" type="STRING" maxLength="2147483647"/>
                      </element>
                      <element name="guid" namespace="http://www.compositesw.com/services/system/admin/user" minOccurs="0">
                        <datatype name="string" namespace="http://www.w3.org/2001/XMLSchema" superTypeName="anySimpleType" superTypeNamespace="http://www.w3.org/2001/XMLSchema" type="STRING" maxLength="2147483647"/>
                      </element>
                      <element name="annotation" namespace="http://www.compositesw.com/services/system/admin/user" minOccurs="0">
                        <datatype name="string" namespace="http://www.w3.org/2001/XMLSchema" superTypeName="anySimpleType" superTypeNamespace="http://www.w3.org/2001/XMLSchema" type="STRING" maxLength="2147483647"/>
                      </element>
                      <element name="attributes" namespace="http://www.compositesw.com/services/system/admin/user" minOccurs="0">
                        <datatype name="attributeList" namespace="http://www.compositesw.com/services/system/util/common" superTypeName="anyType" superTypeNamespace="http://www.w3.org/2001/XMLSchema" subType="COMPLEX_TYPE" type="TREE" refId="1281">
                          <element name="attribute" namespace="http://www.compositesw.com/services/system/util/common" maxOccurs="2147483647" minOccurs="0">
                            <datatype name="attribute" namespace="http://www.compositesw.com/services/system/util/common" superTypeName="anyType" superTypeNamespace="http://www.w3.org/2001/XMLSchema" subType="COMPLEX_TYPE" type="TREE" refId="1537">
                              <element name="name" namespace="http://www.compositesw.com/services/system/util/common">
                                <datatype name="string" namespace="http://www.w3.org/2001/XMLSchema" superTypeName="anySimpleType" superTypeNamespace="http://www.w3.org/2001/XMLSchema" type="STRING" maxLength="2147483647"/>
                              </element>
                              <element name="type" namespace="http://www.compositesw.com/services/system/util/common">
                                <datatype name="attributeType" namespace="http://www.compositesw.com/services/system/util/common" superTypeName="string" superTypeNamespace="http://www.w3.org/2001/XMLSchema" subType="SIMPLE_TYPE" type="STRING" maxLength="2147483647"/>
                              </element>
                              <element name="value" namespace="http://www.compositesw.com/services/system/util/common" minOccurs="0">
                                <datatype name="attributeSimpleValue" namespace="http://www.compositesw.com/services/system/util/common" superTypeName="string" superTypeNamespace="http://www.w3.org/2001/XMLSchema" subType="SIMPLE_TYPE" type="STRING" maxLength="2147483647"/>
                              </element>
                              <element name="valueList" namespace="http://www.compositesw.com/services/system/util/common" minOccurs="0">
                                <datatype name="attributeTypeValueList" namespace="http://www.compositesw.com/services/system/util/common" superTypeName="attributeComplexValue" superTypeNamespace="http://www.compositesw.com/services/system/util/common" subType="COMPLEX_TYPE" type="TREE" refId="1793">
                                  <element name="item" namespace="http://www.compositesw.com/services/system/util/common" maxOccurs="2147483647" minOccurs="0">
                                    <datatype name="attributeTypeValue" namespace="http://www.compositesw.com/services/system/util/common" superTypeName="anyType" superTypeNamespace="http://www.w3.org/2001/XMLSchema" subType="COMPLEX_TYPE" type="TREE" refId="2049">
                                      <element name="type" namespace="http://www.compositesw.com/services/system/util/common">
                                        <datatype name="attributeType" namespace="http://www.compositesw.com/services/system/util/common" superTypeName="string" superTypeNamespace="http://www.w3.org/2001/XMLSchema" subType="SIMPLE_TYPE" type="STRING" maxLength="2147483647"/>
                                      </element>
                                      <element name="value" namespace="http://www.compositesw.com/services/system/util/common" minOccurs="0">
                                        <datatype name="attributeSimpleValue" namespace="http://www.compositesw.com/services/system/util/common" superTypeName="string" superTypeNamespace="http://www.w3.org/2001/XMLSchema" subType="SIMPLE_TYPE" type="STRING" maxLength="2147483647"/>
                                      </element>
                                      <element name="valueList" namespace="http://www.compositesw.com/services/system/util/common" minOccurs="0">
                                        <reference refId="1793"/>
                                      </element>
                                      <element name="valueMap" namespace="http://www.compositesw.com/services/system/util/common" minOccurs="0">
                                        <datatype name="attributeTypeValueMap" namespace="http://www.compositesw.com/services/system/util/common" superTypeName="attributeComplexValue" superTypeNamespace="http://www.compositesw.com/services/system/util/common" subType="COMPLEX_TYPE" type="TREE" refId="2305">
                                          <element name="entry" namespace="http://www.compositesw.com/services/system/util/common" maxOccurs="2147483647" minOccurs="0">
                                            <datatype superTypeName="anyType" superTypeNamespace="http://www.w3.org/2001/XMLSchema" subType="COMPLEX_TYPE" type="TREE" refId="2561">
                                              <element name="key" namespace="http://www.compositesw.com/services/system/util/common">
                                                <reference refId="2049"/>
                                              </element>
                                              <element name="value" namespace="http://www.compositesw.com/services/system/util/common">
                                                <reference refId="2049"/>
                                              </element>
                                            </datatype>
                                          </element>
                                        </datatype>
                                      </element>
                                      <element name="valueArray" namespace="http://www.compositesw.com/services/system/util/common" minOccurs="0">
                                        <datatype name="attributeSimpleValueList" namespace="http://www.compositesw.com/services/system/util/common" superTypeName="attributeComplexValue" superTypeNamespace="http://www.compositesw.com/services/system/util/common" subType="COMPLEX_TYPE" type="TREE" refId="2817">
                                          <element name="item" namespace="http://www.compositesw.com/services/system/util/common" maxOccurs="2147483647" minOccurs="0">
                                            <datatype name="attributeSimpleValue" namespace="http://www.compositesw.com/services/system/util/common" superTypeName="string" superTypeNamespace="http://www.w3.org/2001/XMLSchema" subType="SIMPLE_TYPE" type="STRING" maxLength="2147483647"/>
                                          </element>
                                        </datatype>
                                      </element>
                                    </datatype>
                                  </element>
                                </datatype>
                              </element>
                              <element name="valueMap" namespace="http://www.compositesw.com/services/system/util/common" minOccurs="0">
                                <reference refId="2305"/>
                              </element>
                              <element name="valueArray" namespace="http://www.compositesw.com/services/system/util/common" minOccurs="0">
                                <reference refId="2817"/>
                              </element>
                              <element name="unset" namespace="http://www.compositesw.com/services/system/util/common" minOccurs="0">
                                <datatype name="boolean" namespace="http://www.w3.org/2001/XMLSchema" superTypeName="anySimpleType" superTypeNamespace="http://www.w3.org/2001/XMLSchema" type="INTEGER" minValue="0" maxValue="1"/>
                              </element>
                            </datatype>
                          </element>
                        </datatype>
                      </element>
                    </datatype>
                  </element>
                </datatype>
              </element>
            </datatype>
          </schemaDatatype>
        </datatype>
      </element>
      <element name="fault" direction="OUT">
        <datatype name="fault" extendedName="{http://www.compositesw.com/services/system/util/common}fault" namespace="http://www.compositesw.com/services/system/util/common" referenceDefinitionSet="/services/webservices/system/util/common/operations/CommonSchema" referenceType="{http://www.compositesw.com/services/system/util/common}fault" subType="ELEMENT_DECL" type="XML" contentConstraint="SEQUENCE" schemaConstraint="ANY" componentType="ELEMENT" componentName="{http://www.compositesw.com/services/system/util/common}fault">
          <schemaDatatype>
            <datatype name="fault" namespace="http://www.compositesw.com/services/system/util/common" superTypeName="fault" superTypeNamespace="http://www.compositesw.com/services/system/util/common" subType="ELEMENT_DECL" type="TREE" refId="3073">
              <element name="errorEntry" namespace="http://www.compositesw.com/services/system/util/common" maxOccurs="2147483647" minOccurs="0">
                <datatype name="messageEntry" namespace="http://www.compositesw.com/services/system/util/common" superTypeName="anyType" superTypeNamespace="http://www.w3.org/2001/XMLSchema" subType="COMPLEX_TYPE" type="TREE" refId="3329">
                  <element name="code" namespace="http://www.compositesw.com/services/system/util/common">
                    <datatype name="string" namespace="http://www.w3.org/2001/XMLSchema" superTypeName="anySimpleType" superTypeNamespace="http://www.w3.org/2001/XMLSchema" type="STRING" maxLength="2147483647"/>
                  </element>
                  <element name="name" namespace="http://www.compositesw.com/services/system/util/common">
                    <datatype name="string" namespace="http://www.w3.org/2001/XMLSchema" superTypeName="anySimpleType" superTypeNamespace="http://www.w3.org/2001/XMLSchema" type="STRING" maxLength="2147483647"/>
                  </element>
                  <element name="message" namespace="http://www.compositesw.com/services/system/util/common" minOccurs="0">
                    <datatype name="string" namespace="http://www.w3.org/2001/XMLSchema" superTypeName="anySimpleType" superTypeNamespace="http://www.w3.org/2001/XMLSchema" type="STRING" maxLength="2147483647"/>
                  </element>
                  <element name="detail" namespace="http://www.compositesw.com/services/system/util/common" minOccurs="0">
                    <datatype name="string" namespace="http://www.w3.org/2001/XMLSchema" superTypeName="anySimpleType" superTypeNamespace="http://www.w3.org/2001/XMLSchema" type="STRING" maxLength="2147483647"/>
                  </element>
                  <element name="severity" namespace="http://www.compositesw.com/services/system/util/common" minOccurs="0">
                    <datatype name="messageSeverity" namespace="http://www.compositesw.com/services/system/util/common" superTypeName="string" superTypeNamespace="http://www.w3.org/2001/XMLSchema" subType="SIMPLE_TYPE" type="STRING" maxLength="2147483647"/>
                  </element>
                </datatype>
              </element>
            </datatype>
          </schemaDatatype>
        </datatype>
      </element>
    </datatype>
  </dependency>
  <attribute name="Script" type="STRING">/*
&#x9;getDomains:

&#x9;This procedure is used to get the list of current domains and domain attributes

&#x9;INPUT:
&#x9;&#x9;debug&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;CHAR(1),&#x9;-- Y=debug on.  N=debug off.
&#x9;&#x9;getAttributes&#x9;&#x9;&#x9;&#x9;CHAR(1), &#x9;-- Y=get all domain attributes.  N=get domains only with no attributes.

&#x9;OUTPUT:
&#x9;&#x9;result&#x9;&#x9;&#x9;&#x9;&#x9;PIPE(
&#x9;&#x9;&#x9;domainName &#x9;&#x9;&#x9;VARCHAR,&#x9;&#x9;-- The name of the domain
&#x9;&#x9;&#x9;domainType &#x9;&#x9;&#x9;VARCHAR, &#x9;&#x9;-- The type of domain [LDAP,COMPOSITE,DYNAMIC]
&#x9;&#x9;&#x9;annotation &#x9;&#x9;&#x9;VARCHAR&#x9;&#x9;&#x9;-- The annotation for the domain.
&#x9;&#x9;&#x9;attributeName &#x9;&#x9;VARCHAR, &#x9;&#x9;-- The attribute name
&#x9;&#x9;&#x9;attributeType &#x9;&#x9;VARCHAR, &#x9;&#x9;-- The attribute type [STRING,PASSWORD_STRING]
&#x9;&#x9;&#x9;attributeValue &#x9;&#x9;LONGVARCHAR, &#x9;-- The attribute value
&#x9;&#x9;)

&#x9;Release:&#x9;Modified Date:&#x9;Modified By:&#x9;&#x9;CSW Version:&#x9;Reason:
&#x9;2020.300&#x9;07/02/2020&#x9;&#x9;Mike Tinius&#x9;&#x9;&#x9;7.0.8&#x9;&#x9;&#x9;Created new

&#x9;(c) 2017 TIBCO Software Inc.  All rights reserved.
&#x9;
&#x9;Except as specified below, this software is licensed pursuant to the Eclipse Public License v. 1.0.
&#x9;The details can be found in the file LICENSE.
&#x9;
&#x9;The following proprietary files are included as a convenience, and may not be used except pursuant
&#x9;to valid license to Composite Information Server or TIBCOÂ® Data Virtualization Server:
&#x9;csadmin-XXXX.jar, csarchive-XXXX.jar, csbase-XXXX.jar, csclient-XXXX.jar, cscommon-XXXX.jar,
&#x9;csext-XXXX.jar, csjdbc-XXXX.jar, csserverutil-XXXX.jar, csserver-XXXX.jar, cswebapi-XXXX.jar,
&#x9;and customproc-XXXX.jar (where -XXXX is an optional version number).  Any included third party files
&#x9;are licensed under the terms contained in their own accompanying LICENSE files, generally named .LICENSE.txt.
&#x9;
&#x9;This software is licensed AS-IS. Support for this software is not covered by standard maintenance agreements with TIBCO.
&#x9;If you would like to obtain assistance with this software, such assistance may be obtained through a separate paid consulting
&#x9;agreement with TIBCO.
*/
PROCEDURE getDomains(
&#x9;IN debug&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;CHAR(1),&#x9;-- Y=debug on.  N=debug off.
&#x9;IN getAttributes&#x9;&#x9;&#x9;&#x9;CHAR(1), &#x9;-- Y=get all domain attributes.  N=get domains only with no attributes.
&#x9;OUT result&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;PIPE(domainName VARCHAR, domainType VARCHAR, annotation LONGVARCHAR, attributeName VARCHAR, attributeType VARCHAR, attributeValue LONGVARCHAR)
)
BEGIN
&#x9;DECLARE moduleName&#x9;&#x9;&#x9;&#x9;VARCHAR DEFAULT &apos;getDomains&apos;;
&#x9;DECLARE debugPrintSize&#x9;&#x9;&#x9;INTEGER DEFAULT 63900;
&#x9;DECLARE TYPE recType&#x9;&#x9;&#x9;ROW(domainName VARCHAR, domainType VARCHAR, annotation LONGVARCHAR, attributeName VARCHAR, attributeType VARCHAR, attributeValue LONGVARCHAR);
&#x9;DECLARE rec&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;recType;
&#x9;DECLARE domainType&#x9;&#x9;&#x9;&#x9;VARCHAR;
&#x9;DECLARE request&#x9;&#x9;&#x9;&#x9;&#x9;XML;
&#x9;DECLARE response&#x9;&#x9;&#x9;&#x9;XML;
&#x9;DECLARE faultResponse&#x9;&#x9;&#x9;XML;
&#x9;DECLARE errorMessage&#x9;&#x9;&#x9;LONGVARCHAR;
&#x9;DECLARE ex&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;EXCEPTION;
&#x9;-- XML processing variables
&#x9;DECLARE createResponseStr&#x9;&#x9;LONGVARCHAR;
&#x9;DECLARE resourceEntry&#x9;&#x9;&#x9;LONGVARCHAR;
&#x9;DECLARE resourceAttributesEntry&#x9;LONGVARCHAR;
&#x9;DECLARE xmlEntry&#x9;&#x9;&#x9;&#x9;LONGVARCHAR; 
&#x9;DECLARE numEntities&#x9;&#x9;&#x9;&#x9;INTEGER DEFAULT 0;
&#x9;DECLARE numEntries&#x9;&#x9; &#x9;&#x9;INTEGER;
&#x9;DECLARE numFound&#x9;&#x9;&#x9;&#x9;INTEGER;
&#x9;DECLARE pos1, pos2&#x9;&#x9;&#x9;&#x9;INTEGER;
&#x9;DECLARE pos3, pos4&#x9;&#x9;&#x9;&#x9;INTEGER;
&#x9;DECLARE pos5, pos6, len&#x9;&#x9;&#x9;INTEGER;
&#x9;DECLARE name&#x9;&#x9;&#x9;&#x9;&#x9;LONGVARCHAR; 
&#x9;DECLARE nameValue&#x9;&#x9;&#x9;&#x9;LONGVARCHAR;
&#x9;DECLARE namespaceTag&#x9;&#x9;&#x9;VARCHAR;
&#x9;DECLARE namespaceTag2&#x9;&#x9;&#x9;VARCHAR;

&#x9;-- Get the valid list of domain types
&#x9;BEGIN INDEPENDENT TRANSACTION
&#x9;&#x9;SET request = 
&apos;&lt;user:getDomains xmlns:user=&quot;http://www.compositesw.com/services/system/admin/user&quot; xmlns:common=&quot;http://www.compositesw.com/services/system/util/common&quot;&gt;
  &lt;user:detail&gt;FULL&lt;/user:detail&gt;
&lt;/user:getDomains&gt;
&apos;;
&#x9;&#x9;CALL /services/webservices/system/admin/&quot;user&quot;/operations/getDomains(request, response, faultResponse);
&#x9;EXCEPTION
&#x9;&#x9;ELSE
&#x9;&#x9;&#x9;SET errorMessage = CAST(CURRENT_EXCEPTION.TRACE AS LONGVARCHAR);
&#x9;&#x9;&#x9;CALL LOG(&apos;COEUtilities : EXCEPTION=[&apos;||errorMessage||&apos;]&apos;);
&#x9;&#x9;&#x9;RAISE ex VALUE errorMessage;
&#x9;END;

&#x9;-- Get the namespace tag=ns1 from [&lt;ns1: and &lt;/ns1:] and replace it with [&lt;user: and &lt;/user:]
&#x9;SET createResponseStr = CAST(response AS LONGVARCHAR);
&#x9;IF (createResponseStr IS NOT NULL AND LENGTH(createResponseStr) &gt; 0) THEN
&#x9;&#x9;SET pos1 = INSTR(createResponseStr, &apos;&lt;&apos;);
&#x9;&#x9;SET pos2 = INSTR(createResponseStr, &apos;:&apos;);
&#x9;&#x9;IF (pos1 &gt; 0 AND pos2 &gt; 0) THEN
&#x9;&#x9;&#x9;SET namespaceTag = SUBSTRING(createResponseStr, pos1+1, pos2-pos1-1);
&#x9;&#x9;&#x9;IF (namespaceTag &lt;&gt; &apos;user&apos;) THEN
&#x9;&#x9;&#x9;&#x9;SET createResponseStr = REPLACE(createResponseStr, &apos;&lt;&apos;||namespaceTag||&apos;:&apos;, &apos;&lt;user:&apos;);
&#x9;&#x9;&#x9;&#x9;SET createResponseStr = REPLACE(createResponseStr, &apos;&lt;/&apos;||namespaceTag||&apos;:&apos;, &apos;&lt;/user:&apos;);
&#x9;&#x9;&#x9;END IF;
&#x9;&#x9;END IF;
&#x9;END IF;
&#x9;IF (UPPER(debug) = &apos;Y&apos;) THEN
&#x9;&#x9;CALL PRINT(&apos;&apos;);
&#x9;&#x9;CALL PRINT(SUBSTRING(moduleName||&apos;:     createResponseStr=&apos;||NVL(createResponseStr,&apos;null&apos;),1,debugPrintSize));
&#x9;END IF;

&#x9;-- Extract user:domainType
&#x9;SET numEntities = 0;
&#x9;SET pos1 = INSTR(createResponseStr, &apos;&lt;user:domain&apos;);
&#x9;SET pos2 = INSTR(createResponseStr, &apos;&lt;/user:domain&gt;&apos;);
&#x9;WHILE (pos1 &gt; 0 AND pos2 &gt; 0) DO
&#x9;&#x9;-- Initialize resource record structure
&#x9;&#x9;SET rec = null;

&#x9;&#x9;SET numEntities = numEntities + 1;
&#x9;&#x9;SET len = LENGTH(&apos;&lt;user:domain&gt;&apos;);
&#x9;&#x9;SET resourceEntry = TRIM(SUBSTRING(createResponseStr, pos1, pos2-pos1+len+1));
&#x9;&#x9;IF (UPPER(debug) = &apos;Y&apos;) THEN
&#x9;&#x9;&#x9;CALL PRINT(&apos;&apos;);
&#x9;&#x9;&#x9;CALL PRINT(SUBSTRING(moduleName||&apos;:     user:domain[&apos;||numEntities||&apos;]:&apos;||NVL(resourceEntry,&apos;null&apos;),1,debugPrintSize));
&#x9;&#x9;END IF;

&#x9;&#x9;-- Extract the &quot;domainName&quot; name value
&#x9;&#x9;SET rec.domainName = null;
&#x9;&#x9;SET pos5 = INSTR(resourceEntry, &apos;&lt;user:name&gt;&apos;);
&#x9;&#x9;SET pos6 = INSTR(resourceEntry, &apos;&lt;/user:name&gt;&apos;);
&#x9;&#x9;IF (pos5 &gt; 0 AND pos6 &gt; 0) THEN
&#x9;&#x9;&#x9;SET len = LENGTH(&apos;&lt;user:name&gt;&apos;);
&#x9;&#x9;&#x9;SET rec.domainName = TRIM(SUBSTRING(resourceEntry, pos5+len, pos6-(pos5+len)));
&#x9;&#x9;END IF;
&#x9;&#x9;IF (UPPER(debug) = &apos;Y&apos;) THEN
&#x9;&#x9;&#x9;CALL PRINT(SUBSTRING(moduleName||&apos;:     user:name value=&apos;||NVL(rec.domainName,&apos;[NULL]&apos;),1,debugPrintSize));
&#x9;&#x9;END IF;

&#x9;&#x9;-- Extract the &quot;domainType&quot; name value
&#x9;&#x9;SET rec.domainType = null;
&#x9;&#x9;SET pos5 = INSTR(resourceEntry, &apos;&lt;user:domainType&gt;&apos;);
&#x9;&#x9;SET pos6 = INSTR(resourceEntry, &apos;&lt;/user:domainType&gt;&apos;);
&#x9;&#x9;IF (pos5 &gt; 0 AND pos6 &gt; 0) THEN
&#x9;&#x9;&#x9;SET len = LENGTH(&apos;&lt;user:domainType&gt;&apos;);
&#x9;&#x9;&#x9;SET rec.domainType = TRIM(SUBSTRING(resourceEntry, pos5+len, pos6-(pos5+len)));
&#x9;&#x9;END IF;
&#x9;&#x9;IF (UPPER(debug) = &apos;Y&apos;) THEN
&#x9;&#x9;&#x9;CALL PRINT(SUBSTRING(moduleName||&apos;:     user:domainType value=&apos;||NVL(rec.domainType,&apos;[NULL]&apos;),1,debugPrintSize));
&#x9;&#x9;END IF;

&#x9;&#x9;-- Extract the &quot;annotation&quot; name value
&#x9;&#x9;SET rec.annotation = null;
&#x9;&#x9;SET pos5 = INSTR(resourceEntry, &apos;&lt;user:annotation&gt;&apos;);
&#x9;&#x9;SET pos6 = INSTR(resourceEntry, &apos;&lt;/user:annotation&gt;&apos;);
&#x9;&#x9;IF (pos5 &gt; 0 AND pos6 &gt; 0) THEN
&#x9;&#x9;&#x9;SET len = LENGTH(&apos;&lt;user:annotation&gt;&apos;);
&#x9;&#x9;&#x9;SET rec.annotation = TRIM(SUBSTRING(resourceEntry, pos5+len, pos6-(pos5+len)));
&#x9;&#x9;END IF;
&#x9;&#x9;IF (UPPER(debug) = &apos;Y&apos;) THEN
&#x9;&#x9;&#x9;CALL PRINT(SUBSTRING(moduleName||&apos;:     user:annotation value=&apos;||NVL(rec.annotation,&apos;[NULL]&apos;),1,debugPrintSize));
&#x9;&#x9;END IF;

&#x9;&#x9;-- Extract Resource Attributes
&#x9;&#x9;SET pos3 = INSTR(resourceEntry, &apos;&lt;user:attributes&gt;&apos;);
&#x9;&#x9;SET pos4 = INSTR(resourceEntry, &apos;&lt;/user:attributes&gt;&apos;);
&#x9;&#x9;SET len = LENGTH(&apos;&lt;user:attributes&gt;&apos;);
&#x9;&#x9;SET resourceAttributesEntry = TRIM(SUBSTRING(resourceEntry, pos3, pos4-pos3+len+1));
&#x9;&#x9;IF (UPPER(debug&#x9;) = &apos;Y&apos;) THEN
&#x9;&#x9;&#x9;CALL PRINT(&apos;&apos;);
&#x9;&#x9;&#x9;CALL PRINT(SUBSTRING(moduleName||&apos;:     user:attributes[&apos;||numEntities||&apos;]:&apos;||NVL(resourceAttributesEntry,&apos;null&apos;),1,debugPrintSize));
&#x9;&#x9;END IF;

&#x9;&#x9;-- Determine the namespace tag being used
&#x9;&#x9;SET namespaceTag2 = &apos;ns1&apos;;
&#x9;&#x9;SET pos3 = INSTR(resourceAttributesEntry, &apos;&lt;user:attributes xmlns:&apos;);
&#x9;&#x9;SET pos4 = INSTR(resourceAttributesEntry, &apos;=&apos;);
&#x9;&#x9;IF (pos3 &gt; 0 AND pos4 &gt; 0) THEN
&#x9;&#x9;&#x9;SET pos3 = pos3 + LENGTH(&apos;&lt;user:attributes xmlns:&apos;);
&#x9;&#x9;&#x9;SET namespaceTag2 = SUBSTRING(resourceAttributesEntry, pos3, pos4-pos3);
&#x9;&#x9;&#x9;IF (UPPER(debug) = &apos;Y&apos;) THEN
&#x9;&#x9;&#x9;&#x9;CALL PRINT(moduleName||&apos;:     namespaceTag2=&apos;||namespaceTag2);
&#x9;&#x9;&#x9;END IF;
&#x9;&#x9;END IF;

&#x9;&#x9;SET numEntries = 0;
&#x9;&#x9;SET numFound = 0;
&#x9;&#x9;SET pos3 = INSTR(resourceAttributesEntry, &apos;&lt;&apos;||namespaceTag2||&apos;:attribute&gt;&apos;);
&#x9;&#x9;SET pos4 = INSTR(resourceAttributesEntry, &apos;&lt;/&apos;||namespaceTag2||&apos;:attribute&gt;&apos;);
&#x9;&#x9;attributeLoop:
&#x9;&#x9;WHILE (getAttributes IS NOT NULL AND UPPER(getAttributes) = &apos;Y&apos; AND pos3 &gt; 0 AND pos4 &gt; 0) DO
&#x9;&#x9;&#x9;SET numEntries = numEntries + 1;
&#x9;&#x9;&#x9;SET len = LENGTH(&apos;&lt;&apos;||namespaceTag2||&apos;:attribute&gt;&apos;);
&#x9;&#x9;&#x9;SET xmlEntry = &apos;    &apos;||TRIM(SUBSTRING(resourceAttributesEntry, pos3, pos4-pos3+len+1));
&#x9;&#x9;&#x9;IF (UPPER(debug&#x9;) = &apos;Y&apos;) THEN
&#x9;&#x9;&#x9;&#x9;CALL PRINT(&apos;&apos;);
&#x9;&#x9;&#x9;&#x9;CALL PRINT(SUBSTRING(moduleName||&apos;:     &apos;||namespaceTag2||&apos;:attribute[&apos;||numEntries||&apos;]:&apos;||NVL(xmlEntry,&apos;null&apos;),1,debugPrintSize));
&#x9;&#x9;&#x9;END IF;

&#x9;&#x9;&#x9;-- Extract the name
&#x9;&#x9;&#x9;SET rec.attributeName = null;
&#x9;&#x9;&#x9;SET pos5 = INSTR(xmlEntry, &apos;&lt;&apos;||namespaceTag2||&apos;:name&gt;&apos;);
&#x9;&#x9;&#x9;SET pos6 = INSTR(xmlEntry, &apos;&lt;/&apos;||namespaceTag2||&apos;:name&gt;&apos;);
&#x9;&#x9;&#x9;IF (pos5 &gt; 0 AND pos6 &gt; 0) THEN
&#x9;&#x9;&#x9;&#x9;SET len = LENGTH(&apos;&lt;&apos;||namespaceTag2||&apos;:name&gt;&apos;);
&#x9;&#x9;&#x9;&#x9;SET rec.attributeName = TRIM(SUBSTRING(xmlEntry, pos5+len, pos6-(pos5+len)));
&#x9;&#x9;&#x9;&#x9;SET numFound = numFound + 1;
&#x9;&#x9;&#x9;END IF;

&#x9;&#x9;&#x9;-- Extract the type
&#x9;&#x9;&#x9;SET rec.attributeType = null;
&#x9;&#x9;&#x9;SET pos5 = INSTR(xmlEntry, &apos;&lt;&apos;||namespaceTag2||&apos;:type&gt;&apos;);
&#x9;&#x9;&#x9;SET pos6 = INSTR(xmlEntry, &apos;&lt;/&apos;||namespaceTag2||&apos;:type&gt;&apos;);
&#x9;&#x9;&#x9;IF (pos5 &gt; 0 AND pos6 &gt; 0) THEN
&#x9;&#x9;&#x9;&#x9;SET len = LENGTH(&apos;&lt;&apos;||namespaceTag2||&apos;:type&gt;&apos;);
&#x9;&#x9;&#x9;&#x9;SET rec.attributeType = TRIM(SUBSTRING(xmlEntry, pos5+len, pos6-(pos5+len)));
&#x9;&#x9;&#x9;&#x9;SET numFound = numFound + 1;
&#x9;&#x9;&#x9;END IF;

&#x9;&#x9;&#x9;-- Extract the value
&#x9;&#x9;&#x9;SET rec.attributeValue = null;
&#x9;&#x9;&#x9;SET pos5 = INSTR(xmlEntry, &apos;&lt;&apos;||namespaceTag2||&apos;:value&gt;&apos;);
&#x9;&#x9;&#x9;SET pos6 = INSTR(xmlEntry, &apos;&lt;/&apos;||namespaceTag2||&apos;:value&gt;&apos;);
&#x9;&#x9;&#x9;IF (pos5 &gt; 0 AND pos6 &gt; 0) THEN
&#x9;&#x9;&#x9;&#x9;SET len = LENGTH(&apos;&lt;&apos;||namespaceTag2||&apos;:value&gt;&apos;);
&#x9;&#x9;&#x9;&#x9;SET rec.attributeValue = TRIM(SUBSTRING(xmlEntry, pos5+len, pos6-(pos5+len)));
&#x9;&#x9;&#x9;&#x9;SET numFound = numFound + 1;
&#x9;&#x9;&#x9;END IF;

&#x9;&#x9;&#x9;-- Insert the domain type record
&#x9;&#x9;&#x9;INSERT INTO result VALUES(rec);

&#x9;&#x9;&#x9;-- Get the next attributes entry
&#x9;&#x9;&#x9;SET pos3 = pos4;
&#x9;&#x9;&#x9;SET pos3 = INSTR(resourceAttributesEntry, &apos;&lt;&apos;||namespaceTag2||&apos;:attribute&gt;&apos;, pos3+1);
&#x9;&#x9;&#x9;SET pos4 = INSTR(resourceAttributesEntry, &apos;&lt;/&apos;||namespaceTag2||&apos;:attribute&gt;&apos;, pos4+1);
&#x9;&#x9;&#x9;IF (UPPER(debug&#x9;) = &apos;Y&apos;) THEN
&#x9;&#x9;&#x9;&#x9;CALL PRINT(moduleName||&apos;:  NEXT: pos3=&apos;||pos3||&apos;  pos4=&apos;||pos4);
&#x9;&#x9;&#x9;END IF;
&#x9;&#x9;END WHILE;

&#x9;&#x9;IF (numFound = 0) THEN
&#x9;&#x9;&#x9;-- Insert the domain type record
&#x9;&#x9;&#x9;INSERT INTO result VALUES(rec);
&#x9;&#x9;END IF;

&#x9;&#x9;-- Get the next resource entry
&#x9;&#x9;SET pos1 = pos2;
&#x9;&#x9;SET pos1 = INSTR(createResponseStr, &apos;&lt;user:domain&apos;, pos1+1);
&#x9;&#x9;SET pos2 = INSTR(createResponseStr, &apos;&lt;/user:domain&gt;&apos;, pos2+1);
&#x9;&#x9;IF (UPPER(debug&#x9;) = &apos;Y&apos;) THEN
&#x9;&#x9;&#x9;CALL PRINT(moduleName||&apos;:     NEXT: pos1=&apos;||pos1||&apos;  pos2=&apos;||pos2);
&#x9;&#x9;END IF;
&#x9;END WHILE;
END</attribute>
  <attribute name="creationDate" type="LONG">1593440627825</attribute>
  <attribute name="creatorUserDomain" type="STRING">composite</attribute>
  <attribute name="creatorUserId" type="INTEGER">-1973</attribute>
  <attribute name="creatorUserName" type="STRING">admin</attribute>
  <attribute name="explicitly.designed" type="BOOLEAN">false</attribute>
  <attribute name="lastModifiedDate" type="LONG">1595074833737</attribute>
  <attribute name="lastModifiedUserDomain" type="STRING">composite</attribute>
  <attribute name="lastModifiedUserId" type="INTEGER">-1973</attribute>
  <attribute name="lastModifiedUserName" type="STRING">admin</attribute>
  <attribute name="model" type="NULL"/>
  <attribute name="native_only" type="STRING">false</attribute>
  <attribute name="references" type="MAP">
    <item>
      <key type="STRING">9/153</key>
      <value type="STRING_ARRAY">
        <item>lib</item>
        <item>debug</item>
        <item>Print</item>
      </value>
    </item>
    <item>
      <key type="STRING">9/141</key>
      <value type="STRING_ARRAY">
        <item>lib</item>
        <item>debug</item>
        <item>Print</item>
      </value>
    </item>
    <item>
      <key type="STRING">9/163</key>
      <value type="STRING_ARRAY">
        <item>lib</item>
        <item>debug</item>
        <item>Print</item>
      </value>
    </item>
    <item>
      <key type="STRING">9/244</key>
      <value type="STRING_ARRAY">
        <item>lib</item>
        <item>debug</item>
        <item>Print</item>
      </value>
    </item>
    <item>
      <key type="STRING">10/230</key>
      <value type="STRING_ARRAY">
        <item>lib</item>
        <item>debug</item>
        <item>Print</item>
      </value>
    </item>
    <item>
      <key type="STRING">10/174</key>
      <value type="STRING_ARRAY">
        <item>lib</item>
        <item>debug</item>
        <item>Print</item>
      </value>
    </item>
    <item>
      <key type="STRING">9/82</key>
      <value type="STRING_ARRAY">
        <item>lib</item>
        <item>debug</item>
        <item>Log</item>
      </value>
    </item>
    <item>
      <key type="STRING">9/162</key>
      <value type="STRING_ARRAY">
        <item>lib</item>
        <item>debug</item>
        <item>Print</item>
      </value>
    </item>
    <item>
      <key type="STRING">8/101</key>
      <value type="STRING_ARRAY">
        <item>lib</item>
        <item>debug</item>
        <item>Print</item>
      </value>
    </item>
    <item>
      <key type="STRING">8/100</key>
      <value type="STRING_ARRAY">
        <item>lib</item>
        <item>debug</item>
        <item>Print</item>
      </value>
    </item>
    <item>
      <key type="STRING">10/189</key>
      <value type="STRING_ARRAY">
        <item>lib</item>
        <item>debug</item>
        <item>Print</item>
      </value>
    </item>
    <item>
      <key type="STRING">10/188</key>
      <value type="STRING_ARRAY">
        <item>lib</item>
        <item>debug</item>
        <item>Print</item>
      </value>
    </item>
    <item>
      <key type="STRING">9/117</key>
      <value type="STRING_ARRAY">
        <item>lib</item>
        <item>debug</item>
        <item>Print</item>
      </value>
    </item>
    <item>
      <key type="STRING">9/116</key>
      <value type="STRING_ARRAY">
        <item>lib</item>
        <item>debug</item>
        <item>Print</item>
      </value>
    </item>
    <item>
      <key type="STRING">9/129</key>
      <value type="STRING_ARRAY">
        <item>lib</item>
        <item>debug</item>
        <item>Print</item>
      </value>
    </item>
  </attribute>
  <attribute name="resourceModifiedDateOnSourceCISSite" type="LONG">1593440627825</attribute>
</metadata>